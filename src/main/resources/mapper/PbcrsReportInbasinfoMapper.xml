<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hkbank.pbcrs.mapper.PbcrsReportInbasinfoMapper">

	<resultMap id="BaseResultMap" type="com.hkbank.pbcrs.model.PbcrsReportInbasinfo">

		<id column="INBASINFOSEQNO" jdbcType="VARCHAR" property="SeqNo" />
		<!-- <result column="BSSGMTSEQNO" jdbcType="VARCHAR" property="BsSgmtSeqNo" 
			/> <result column="IDSGMTSEQNO" jdbcType="VARCHAR" property="IDSgmtSeqNo" 
			/> <result column="FCSINFSGMTSEQNO" jdbcType="VARCHAR" property="FcsInfSgmtSeqNo" 
			/> <result column="SPSINFSGMTSEQNO" jdbcType="VARCHAR" property="SpsInfSgmtSeqNo" 
			/> <result column="EDUINFSGMTSEQNO" jdbcType="VARCHAR" property="EduInfSgmtSeqNo" 
			/> <result column="OCTPNINFSGMTSEQNO" jdbcType="VARCHAR" property="OctpnInfSgmtSeqNo" 
			/> <result column="REDNCINFSGMTSEQNO" jdbcType="VARCHAR" property="RedncInfSgmtSeqNo" 
			/> <result column="MLGINFSGMTSEQNO" jdbcType="VARCHAR" property="MlgInfSgmtSeqNo" 
			/> <result column="INCINFSGMTSEQNO" jdbcType="VARCHAR" property="IncInfSgmtSeqNo" 
			/> -->
		<association property="BsSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportBssgmt">
			<!-- WARNING - @mbggenerated This element is automatically generated by 
				MyBatis Generator, do not modify. This element was generated on Tue Mar 26 
				16:20:32 CST 2019. -->
			<id column="BSSGMTSEQNO" jdbcType="VARCHAR" property="BsSgmtSeqNo" />
			<result column="INFRECTYPE" jdbcType="VARCHAR" property="InfRecType" />
			<result column="NAME" jdbcType="VARCHAR" property="Name" />
			<result column="IDTYPE" jdbcType="VARCHAR" property="IDType" />
			<result column="IDNUM" jdbcType="VARCHAR" property="IDNum" />
			<result column="INFSURCCODE" jdbcType="VARCHAR" property="InfSurcCode" />
			<result column="RPTDATE" jdbcType="VARCHAR" property="RptDate" />
			<result column="RPTDATECODE" jdbcType="VARCHAR" property="RptDateCode" />
			<result column="CIMOC" jdbcType="VARCHAR" property="Cimoc" />
			<result column="CUSTOMERTYPE" jdbcType="VARCHAR" property="CustomerType" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
		</association>
		<association property="IDSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportIdsgmt">
			<!-- WARNING - @mbggenerated This element is automatically generated by 
				MyBatis Generator, do not modify. This element was generated on Wed Apr 24 
				11:14:08 CST 2019. -->
			<id column="IDSGMTSEQNO" jdbcType="VARCHAR" property="IDSgmtSeqNo" />
			<result column="IDNM" jdbcType="VARCHAR" property="IDNm" />
			<result column="IDINFOUPDATE" jdbcType="VARCHAR" property="IDInfoUpDate" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
		</association>
		<association property="FcsInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportFcsinfsgmt">
			<!-- WARNING - @mbggenerated This element is automatically generated by 
				MyBatis Generator, do not modify. This element was generated on Wed Apr 24 
				10:25:54 CST 2019. -->
			<id column="FCSINFSGMTSEQNO" jdbcType="VARCHAR" property="FcsInfSgmtSeqNo" />
			<result column="SEX" jdbcType="VARCHAR" property="Sex" />
			<result column="DOB" jdbcType="VARCHAR" property="DOB" />
			<result column="NATION" jdbcType="VARCHAR" property="Nation" />
			<result column="HOUSEADD" jdbcType="VARCHAR" property="HouseAdd" />
			<result column="HHDIST" jdbcType="VARCHAR" property="HhDist" />
			<result column="CELLPHONE" jdbcType="VARCHAR" property="CellPhone" />
			<result column="EMAIL" jdbcType="VARCHAR" property="Email" />
			<result column="FCSINFOUPDATE" jdbcType="VARCHAR" property="FcsInfoUpDate" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
		</association>
		<association property="SpsInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportSpsinfsgmt">
			<!-- WARNING - @mbggenerated This element is automatically generated by 
				MyBatis Generator, do not modify. This element was generated on Wed Apr 24 
				10:25:54 CST 2019. -->
			<id column="SPSINFSGMTSEQNO" jdbcType="VARCHAR" property="SpsInfSgmtSeqNo" />
			<result column="MARISTATUS" jdbcType="VARCHAR" property="MariStatus" />
			<result column="SPONAME" jdbcType="VARCHAR" property="SpoName" />
			<result column="SPOIDTYPE" jdbcType="VARCHAR" property="SpoIDType" />
			<result column="SPOIDNUM" jdbcType="VARCHAR" property="SpoIDNum" />
			<result column="SPOTEL" jdbcType="VARCHAR" property="SpoTel" />
			<result column="SPSCMPYNM" jdbcType="VARCHAR" property="SpsCmpyNm" />
			<result column="SPSINFOUPDATE" jdbcType="VARCHAR" property="SpsInfoUpDate" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
		</association>
		<association property="EduInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportEduinfsgmt">
			<!-- WARNING - @mbggenerated This element is automatically generated by 
				MyBatis Generator, do not modify. This element was generated on Wed Apr 24 
				10:25:54 CST 2019. -->
			<id column="EDUINFSGMTSEQNO" jdbcType="VARCHAR" property="EduInfSgmtSeqNo" />
			<result column="EDULEVEL" jdbcType="VARCHAR" property="EduLevel" />
			<result column="ACADEGREE" jdbcType="VARCHAR" property="AcaDegree" />
			<result column="EDUINFOUPDATE" jdbcType="VARCHAR" property="EduInfoUpDate" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
		</association>
		<association property="OctpnInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportOctpninfsgmt">
			<!-- WARNING - @mbggenerated This element is automatically generated by 
				MyBatis Generator, do not modify. This element was generated on Wed Apr 24 
				10:58:22 CST 2019. -->
			<id column="OCTPNINFSGMTSEQNO" jdbcType="VARCHAR" property="OctpnInfSgmtSeqNo" />
			<result column="EMPSTATUS" jdbcType="VARCHAR" property="EmpStatus" />
			<result column="CPNNAME" jdbcType="VARCHAR" property="CpnName" />
			<result column="CPNTYPE" jdbcType="VARCHAR" property="CpnType" />
			<result column="INDUSTRY" jdbcType="VARCHAR" property="Industry" />
			<result column="CPNADDR" jdbcType="VARCHAR" property="CpnAddr" />
			<result column="CPNPC" jdbcType="VARCHAR" property="CpnPc" />
			<result column="CPNDIST" jdbcType="VARCHAR" property="CpnDist" />
			<result column="CPNTEL" jdbcType="VARCHAR" property="CpnTEL" />
			<result column="OCCUPATION" jdbcType="VARCHAR" property="Occupation" />
			<result column="TITLE" jdbcType="VARCHAR" property="Title" />
			<result column="TECHTITLE" jdbcType="VARCHAR" property="TechTitle" />
			<result column="WORKSTARTDATE" jdbcType="VARCHAR" property="WorkStartDate" />
			<result column="OCTPNINFOUPDATE" jdbcType="VARCHAR" property="OctpnInfoUpDate" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
		</association>
		<association property="RedncInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportRedncinfsgmt">
			<!-- WARNING - @mbggenerated This element is automatically generated by 
				MyBatis Generator, do not modify. This element was generated on Wed Apr 24 
				10:58:22 CST 2019. -->
			<id column="REDNCINFSGMTSEQNO" jdbcType="VARCHAR" property="RedncInfSgmtSeqNo" />
			<result column="RESISTATUS" jdbcType="VARCHAR" property="ResiStatus" />
			<result column="RESIADDR" jdbcType="VARCHAR" property="ResiAddr" />
			<result column="RESIPC" jdbcType="VARCHAR" property="ResiPc" />
			<result column="RESIDIST" jdbcType="VARCHAR" property="ResiDist" />
			<result column="HOMETEL" jdbcType="VARCHAR" property="HomeTel" />
			<result column="RESIINFOUPDATE" jdbcType="VARCHAR" property="ResiInfoUpDate" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
		</association>
		<association property="MlgInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportMlginfsgmt">
			<!-- WARNING - @mbggenerated This element is automatically generated by 
				MyBatis Generator, do not modify. This element was generated on Wed Apr 24 
				10:58:22 CST 2019. -->
			<id column="MLGINFSGMTSEQNO" jdbcType="VARCHAR" property="MlgInfSgmtSeqNo" />
			<result column="MAILADDR" jdbcType="VARCHAR" property="MailAddr" />
			<result column="MAILPC" jdbcType="VARCHAR" property="MailPc" />
			<result column="MAILDIST" jdbcType="VARCHAR" property="MailDist" />
			<result column="MLGINFOUPDATE" jdbcType="VARCHAR" property="MlgInfoUpDate" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
		</association>
		<association property="IncInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportIncinfsgmt">
			<!-- WARNING - @mbggenerated This element is automatically generated by 
				MyBatis Generator, do not modify. This element was generated on Wed Apr 24 
				10:58:22 CST 2019. -->
			<id column="INCINFSGMTSEQNO" jdbcType="VARCHAR" property="IncInfSgmtSeqNo" />
			<result column="ANNLINC" jdbcType="VARCHAR" property="AnnlInc" />
			<result column="TAXINCOME" jdbcType="VARCHAR" property="TaxIncome" />
			<result column="INCINFOUPDATE" jdbcType="VARCHAR" property="IncInfoUpDate" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
		</association>

	</resultMap>
	<select id="selectByMap" parameterType="map" resultMap="BaseResultMap">
		<!-- 通过主键来进行报送的是报送个人基本信息修改 -->
		<if test="seqNoS != null and seqNoS != ''">
			<include refid="sql_selectByMapM" />
		</if>
		<!-- 不通过主键查询而是直接通过时间和系统号查询时批量调取 -->
		<if test="seqNoS == null or seqNoS == ''">
			<include refid="sql_selectByMap" />
		</if>
		
	</select>
	<select id="selectByMapCount" parameterType="map" resultType="int">
		<!-- 通过主键来进行报送的是报送个人基本信息修改 -->
		<if test="seqNoS != null and seqNoS != ''">
			<include refid="sql_selectCountM" />
		</if>
		<!-- 不通过主键查询而是直接通过时间和系统号查询时批量调取 -->
		<if test="seqNoS == null or seqNoS == ''">
			<include refid="sql_selectCount" />
		</if>
	</select>
	<!-- 查询原表数据 -->
	<sql id="sql_selectByMap">
		select * from (select t.*,rownum rn from(select
			 BSSGMTSEQNO INBASINFOSEQNO,
        nvl(b.RPTDATECODE,' ') RPTDATECODE,
       
        b.cimoc CIMOC,
        nvl(b.CUSTOMERTYPE,' ') CUSTOMERTYPE,
        nvl(b.BSSGMTSEQNO,' ')BSSGMTSEQNO,
        nvl(b.INFRECTYPE,' ')INFRECTYPE,
        nvl(b.NAME,' ')NAME,
        nvl(b.IDTYPE,' ')IDTYPE,
        nvl(b.IDNUM,' ')IDNUM,
        nvl(b.INFSURCCODE,' ')INFSURCCODE,
        nvl(b.RPTDATE,' ')RPTDATE,
        nvl(t.FCSINFSGMTSEQNO,' ')FCSINFSGMTSEQNO,
        nvl(t.SEX,' ')SEX,
      
        nvl(t.DOB,' ')DOB,
        nvl(t.NATION,' ')NATION,
        nvl(t.HOUSEADD,' ')HOUSEADD,
        nvl(t.HHDIST,' ')HHDIST,
        case when length(t.CELLPHONE) != 11 then ' '
             when t.CELLPHONE is null then ' '
        else t.CELLPHONE end CELLPHONE,
        nvl(t.EMAIL,' ')EMAIL,
         nvl(t.FCSINFOUPDATE,' ')FCSINFOUPDATE,
       
        nvl(t1.SPSINFSGMTSEQNO,' ')SPSINFSGMTSEQNO,
        nvl(t1.MARISTATUS,' ')MARISTATUS,
        
         case when
          t1.MARISTATUS='99' or  t1.MARISTATUS='10' or t1.MARISTATUS='30' or t1.MARISTATUS='40'
          or t1.MARISTATUS='90' or t1.MARISTATUS='91' then ''
         else nvl(t1.SPONAME,' ') end  SPONAME,
    
          case when
          t1.MARISTATUS='99' or  t1.MARISTATUS='10' or t1.MARISTATUS='30' or t1.MARISTATUS='40'
          or t1.MARISTATUS='90' or t1.MARISTATUS='91' then ''
         else nvl(t1.SPOIDTYPE,' ') end  SPOIDTYPE,
          case when
          t1.MARISTATUS='99' or  t1.MARISTATUS='10' or t1.MARISTATUS='30' or t1.MARISTATUS='40'
          or t1.MARISTATUS='90' or t1.MARISTATUS='91' then ''
         else nvl(t1.SPOIDNUM,' ') end  SPOIDNUM,
          case when
          t1.MARISTATUS='99' or  t1.MARISTATUS='10' or t1.MARISTATUS='30' or t1.MARISTATUS='40'
          or t1.MARISTATUS='90' or t1.MARISTATUS='91' then ''
         else nvl(t1.SPOTEL,' ') end  SPOTEL,
        case when
          t1.MARISTATUS='99' or  t1.MARISTATUS='10' or t1.MARISTATUS='30' or t1.MARISTATUS='40'
          or t1.MARISTATUS='90' or t1.MARISTATUS='91' then ''
         else nvl(t1.SPSCMPYNM,' ') end  SPSCMPYNM,
        nvl(to_char(to_date(t1.SPSINFOUPDATE,'yyyymmdd'),'yyyy-mm-dd'),' ')SPSINFOUPDATE,
     
        nvl(t2.EDUINFSGMTSEQNO,' ')EDUINFSGMTSEQNO,
        nvl(t2.EDULEVEL,' ')EDULEVEL,
        nvl(t2.ACADEGREE,' ')ACADEGREE,
        nvl(to_char(to_date(t2.EDUINFOUPDATE,'yyyymmdd'),'yyyy-mm-dd'),' ')EDUINFOUPDATE,
       
        nvl(t3.OCTPNINFSGMTSEQNO,' ')OCTPNINFSGMTSEQNO,
        nvl(t3.EMPSTATUS,' ')EMPSTATUS,
        
        case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.CPNNAME,' ') end CPNNAME,
        case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.CPNTYPE,' ') end CPNTYPE,
         case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.INDUSTRY,' ') end INDUSTRY,                  
        case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.CPNADDR,' ') end CPNADDR,
       case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.CPNPC,' ') end CPNPC,
       case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.CPNDIST,' ') end CPNDIST,
       case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.CPNTEL,' ') end CPNTEL,
        case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.OCCUPATION,' ') end OCCUPATION,
         case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.TITLE,' ') end TITLE,
        case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.TECHTITLE,' ') end TECHTITLE,
       case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.WORKSTARTDATE,' ') end WORKSTARTDATE,
        nvl(to_char(to_date(t3.OCTPNINFOUPDATE,'yyyymmdd'),'yyyy-mm-dd'),' ')OCTPNINFOUPDATE,
      
        nvl(t4.REDNCINFSGMTSEQNO,' ')REDNCINFSGMTSEQNO,
        nvl(t4.RESISTATUS,' ')RESISTATUS,
        nvl(t4.RESIADDR,' ')RESIADDR,
        nvl(t4.RESIPC,' ')RESIPC,
        nvl(t4.RESIDIST,' ')RESIDIST,
        nvl(t4.HOMETEL,' ')HOMETEL,
        nvl(to_char(to_date(t4.RESIINFOUPDATE,'yyyymmdd'),'yyyy-mm-dd'),' ')RESIINFOUPDATE,
       
        nvl(t5.MLGINFSGMTSEQNO,' ')MLGINFSGMTSEQNO,
        nvl(t5.MAILADDR,' ')MAILADDR,
        nvl(t5.MAILPC,' ')MAILPC,
        nvl(t5.MAILDIST,' ')MAILDIST,
         nvl(to_char(to_date(t5.MLGINFOUPDATE,'yyyymmdd'),'yyyy-mm-dd'),' ')MLGINFOUPDATE
		from PBCRS_REPORT_BSSGMT b
		left join
		PBCRS_REPORT_FCSINFSGMT t on b.bssgmtseqno=t.fcsinfsgmtseqno
		<if test="sysid != null and sysid != ''">
			and t.sourcesys=#{sysid}
		</if>
		<if test="etl_Date != null and etl_Date != ''">
			
			and t.etl_date=#{etl_Date}
		</if>
		left join
		PBCRS_REPORT_SPSINFSGMT t1 on b.bssgmtseqno=t1.spsinfsgmtseqno
		<if test="sysid != null and sysid != ''">
			and t1.sourcesys=#{sysid}
		</if>
		<if test="etl_Date != null and etl_Date != ''">
			
			and t1.etl_date=#{etl_Date}
		</if>
		left join
		PBCRS_REPORT_EDUINFSGMT t2 on b.bssgmtseqno=t2.eduinfsgmtseqno
		<if test="sysid != null and sysid != ''">
			and t2.sourcesys=#{sysid}
		</if>
		<if test="etl_Date != null and etl_Date != ''">
			
			and t2.etl_date=#{etl_Date}
		</if>
		left join
		PBCRS_REPORT_OCTPNINFSGMT t3 on b.bssgmtseqno=t3.octpninfsgmtseqno
		<if test="sysid != null and sysid != ''">
			and t3.sourcesys=#{sysid}
		</if>
		<if test="etl_Date != null and etl_Date != ''">
			
			and t3.etl_date=#{etl_Date}
		</if>
		left join
		PBCRS_REPORT_REDNCINFSGMT t4 on b.bssgmtseqno=t4.redncinfsgmtseqno
		<if test="sysid != null and sysid != ''">
			and t4.sourcesys=#{sysid}
		</if>
		<if test="etl_Date != null and etl_Date != ''">
			
			and t4.etl_date=#{etl_Date}
		</if>
		left join
		PBCRS_REPORT_MLGINFSGMT t5 on b.bssgmtseqno=t5.mlginfsgmtseqno
		<if test="sysid != null and sysid != ''">
			and t5.sourcesys=#{sysid}
		</if>
		<if test="etl_Date != null and etl_Date != ''">
			
			and t5.etl_date=#{etl_Date}
		</if>
		where
		
		b.etl_date=#{etl_Date}
		<if test="sysid != null and sysid != ''">
			and b.sourcesys=#{sysid}
		</if>
		and b.reportflag='0'
		 <!-- and fn_checkidcard(IDNUM)=0 and  IDTYPE='10' and  IDNUM   is not null -->
		) t where rownum &lt; =#{pageEnd} 
		)where rn > #{pageBegin}
	
	</sql>
	
	
	<!-- 查询更改记录表数据 -->
	<sql id="sql_selectByMapM">
		select * from (select t.*,rownum rn from(select
        BSSGMTSEQNO INBASINFOSEQNO,
        nvl(b.RPTDATECODE,' ') RPTDATECODE,
       
        b.cimoc CIMOC,
        nvl(b.CUSTOMERTYPE,' ') CUSTOMERTYPE,
        nvl(b.BSSGMTSEQNO,' ')BSSGMTSEQNO,
        nvl(b.INFRECTYPE,' ')INFRECTYPE,
        nvl(b.NAME,' ')NAME,
        nvl(b.IDTYPE,' ')IDTYPE,
        nvl(b.IDNUM,' ')IDNUM,
        nvl(b.INFSURCCODE,' ')INFSURCCODE,
        nvl(b.RPTDATE,' ')RPTDATE,
        nvl(t.FCSINFSGMTSEQNO,' ')FCSINFSGMTSEQNO,
        nvl(t.SEX,' ')SEX,
      
        nvl(t.DOB,' ')DOB,
        nvl(t.NATION,' ')NATION,
        nvl(t.HOUSEADD,' ')HOUSEADD,
        nvl(t.HHDIST,' ')HHDIST,
        case when length(t.CELLPHONE) != 11 then ' '
             when t.CELLPHONE is null then ' '
        else t.CELLPHONE end CELLPHONE,
        nvl(t.EMAIL,' ')EMAIL,
         nvl(t.FCSINFOUPDATE,' ')FCSINFOUPDATE,
       
        nvl(t1.SPSINFSGMTSEQNO,' ')SPSINFSGMTSEQNO,
        nvl(t1.MARISTATUS,' ')MARISTATUS,
        
         case when
          t1.MARISTATUS='99' or  t1.MARISTATUS='10' or t1.MARISTATUS='30' or t1.MARISTATUS='40'
          or t1.MARISTATUS='90' or t1.MARISTATUS='91' then ''
         else nvl(t1.SPONAME,' ') end  SPONAME,
    
          case when
          t1.MARISTATUS='99' or  t1.MARISTATUS='10' or t1.MARISTATUS='30' or t1.MARISTATUS='40'
          or t1.MARISTATUS='90' or t1.MARISTATUS='91' then ''
         else nvl(t1.SPOIDTYPE,' ') end  SPOIDTYPE,
          case when
          t1.MARISTATUS='99' or  t1.MARISTATUS='10' or t1.MARISTATUS='30' or t1.MARISTATUS='40'
          or t1.MARISTATUS='90' or t1.MARISTATUS='91' then ''
         else nvl(t1.SPOIDNUM,' ') end  SPOIDNUM,
          case when
          t1.MARISTATUS='99' or  t1.MARISTATUS='10' or t1.MARISTATUS='30' or t1.MARISTATUS='40'
          or t1.MARISTATUS='90' or t1.MARISTATUS='91' then ''
         else nvl(t1.SPOTEL,' ') end  SPOTEL,
        case when
          t1.MARISTATUS='99' or  t1.MARISTATUS='10' or t1.MARISTATUS='30' or t1.MARISTATUS='40'
          or t1.MARISTATUS='90' or t1.MARISTATUS='91' then ''
         else nvl(t1.SPSCMPYNM,' ') end  SPSCMPYNM,
        nvl(to_char(to_date(t1.SPSINFOUPDATE,'yyyymmdd'),'yyyy-mm-dd'),' ')SPSINFOUPDATE,
     
        nvl(t2.EDUINFSGMTSEQNO,' ')EDUINFSGMTSEQNO,
        nvl(t2.EDULEVEL,' ')EDULEVEL,
        nvl(t2.ACADEGREE,' ')ACADEGREE,
        nvl(to_char(to_date(t2.EDUINFOUPDATE,'yyyymmdd'),'yyyy-mm-dd'),' ')EDUINFOUPDATE,
       
        nvl(t3.OCTPNINFSGMTSEQNO,' ')OCTPNINFSGMTSEQNO,
        nvl(t3.EMPSTATUS,' ')EMPSTATUS,
        
        case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.CPNNAME,' ') end CPNNAME,
        case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.CPNTYPE,' ') end CPNTYPE,
         case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.INDUSTRY,' ') end INDUSTRY,                  
        case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.CPNADDR,' ') end CPNADDR,
       case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.CPNPC,' ') end CPNPC,
       case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.CPNDIST,' ') end CPNDIST,
       case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.CPNTEL,' ') end CPNTEL,
        case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.OCCUPATION,' ') end OCCUPATION,
         case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.TITLE,' ') end TITLE,
        case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.TECHTITLE,' ') end TECHTITLE,
       case when t3.empstatus='99' or t3.empstatus='27' or t3.empstatus='31' or t3.empstatus='51'
                        or t3.empstatus='54' or t3.empstatus='70' or t3.empstatus='80' or t3.empstatus='90' then ''
                        else nvl(t3.WORKSTARTDATE,' ') end WORKSTARTDATE,
        nvl(to_char(to_date(t3.OCTPNINFOUPDATE,'yyyymmdd'),'yyyy-mm-dd'),' ')OCTPNINFOUPDATE,
      
        nvl(t4.REDNCINFSGMTSEQNO,' ')REDNCINFSGMTSEQNO,
        nvl(t4.RESISTATUS,' ')RESISTATUS,
        nvl(t4.RESIADDR,' ')RESIADDR,
        nvl(t4.RESIPC,' ')RESIPC,
        nvl(t4.RESIDIST,' ')RESIDIST,
        nvl(t4.HOMETEL,' ')HOMETEL,
        nvl(to_char(to_date(t4.RESIINFOUPDATE,'yyyymmdd'),'yyyy-mm-dd'),' ')RESIINFOUPDATE,
       
        nvl(t5.MLGINFSGMTSEQNO,' ')MLGINFSGMTSEQNO,
        nvl(t5.MAILADDR,' ')MAILADDR,
        nvl(t5.MAILPC,' ')MAILPC,
        nvl(t5.MAILDIST,' ')MAILDIST,
         nvl(to_char(to_date(t5.MLGINFOUPDATE,'yyyymmdd'),'yyyy-mm-dd'),' ')MLGINFOUPDATE
    from PBCRS_REPORT_BSSGMTM b
    left join
    PBCRS_REPORT_FCSINFSGMTM t on b.bssgmtseqno=t.fcsinfsgmtseqno
    left join
    PBCRS_REPORT_SPSINFSGMTM t1 on b.bssgmtseqno=t1.spsinfsgmtseqno
    left join
    PBCRS_REPORT_EDUINFSGMTM t2 on b.bssgmtseqno=t2.eduinfsgmtseqno
    left join
    PBCRS_REPORT_OCTPNINFSGMTM t3 on b.bssgmtseqno=t3.octpninfsgmtseqno
    left join
    PBCRS_REPORT_REDNCINFSGMTM t4 on b.bssgmtseqno=t4.redncinfsgmtseqno
    left join
    PBCRS_REPORT_MLGINFSGMTM t5 on b.bssgmtseqno=t5.mlginfsgmtseqno
    where
     b.reportflag='0'
     <if test="sysid != null and sysid != ''">
			and b.sourcesys=#{sysid}
		</if>
		<if test="seqNoS != null and seqNoS != ''">
			and b.BsSgmtSeqNo in (${seqNoS})
		</if>
		) t where rownum &lt; =#{pageEnd} 
		)where rn > #{pageBegin}
	
	</sql>
	
	
	
	<!-- 查询原表总数 -->
	<sql id="sql_selectCount">
		select count(1)
		from PBCRS_REPORT_BSSGMT b
		
		where
		
		b.etl_date=#{etl_Date}
		<if test="sysid != null and sysid != ''">
			and b.sourcesys=#{sysid}
		</if>
		and b.reportflag='0'
	
	</sql>
	<!-- 查询更改记录表总数 -->
	<sql id="sql_selectCountM">
		select count(1) from PBCRS_REPORT_BSSGMTM b
    	where b.reportflag='0'
    	<if test="sysid != null and sysid != ''">
			and b.sourcesys=#{sysid}
		</if>
		<if test="seqNoS != null and seqNoS != ''">
			and b.BsSgmtSeqNo in (${seqNoS})
		</if>
	
	</sql>
	
	
	
	

</mapper>