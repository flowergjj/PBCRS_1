<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hkbank.pbcrs.mapper.PbcrsReportMotcltctrinfMapper">
	<resultMap id="BaseResultMap"
		type="com.hkbank.pbcrs.model.PbcrsReportMotcltctrinf">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Tue Mar 26 
			16:20:32 CST 2019. -->
		<id column="MOTGACLTALCTRCTINFSEQNO" jdbcType="VARCHAR"
			property="MotgaCltalCtrctInfSeqNo" />
		<result column="MOTGACLTALCTRCTBSSGMTSEQNO" jdbcType="VARCHAR"
			property="MotgaCltalCtrctBsSgmtSeqNo" />
		<result column="MOTGACLTALBSINFSGMTSEQNO" jdbcType="VARCHAR"
			property="MotgaCltalBsInfSgmtSeqNo" />
		<result column="COMRECINFSGMTSEQNO" jdbcType="VARCHAR"
			property="ComRecInfSgmtSeqNo" />
		<result column="MOTGAPROPTINFSGMTSEQNO" jdbcType="VARCHAR"
			property="MotgaProptInfSgmtSeqNo" />
		<result column="CLTALINFSGMTSEQNO" jdbcType="VARCHAR" property="CltalInfSgmtSeqNo" />

		<association property="MotCltCtrBsSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportMotcltctrbssgmt">
			<id column="MOTGACLTALCTRCTBSSGMTSEQNO" jdbcType="VARCHAR"
				property="MotgaCltalCtrctBsSgmtSeqNo" />
			<result column="INFRECTYPE" jdbcType="VARCHAR" property="InfRecType" />
			<result column="CCCODE" jdbcType="VARCHAR" property="CcCode" />
			<result column="RPTDATE" jdbcType="VARCHAR" property="RptDate" />
			<result column="RPTDATECODE" jdbcType="VARCHAR" property="RptDateCode" />
			<result column="INFOIDTYPE" jdbcType="VARCHAR" property="InfoIDType" />
			<result column="NAME" jdbcType="VARCHAR" property="Name" />
			<result column="CERTTYPE" jdbcType="VARCHAR" property="CertType" />
			<result column="CERTNUM" jdbcType="VARCHAR" property="CertNum" />
			<result column="MNGMTORGCODE" jdbcType="VARCHAR" property="MngmtOrgCode" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
		</association>

		<association property="MotCltBsInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportMotcltbsinfsgmt">
			<id column="MOTGACLTALBSINFSGMTSEQNO" jdbcType="VARCHAR"
				property="MotgaCltalBsInfSgmtSeqNo" />
			<result column="GUARTYPE" jdbcType="VARCHAR" property="GuarType" />
			<result column="CCAMT" jdbcType="VARCHAR" property="CcAmt" />
			<result column="CY" jdbcType="VARCHAR" property="Cy" />
			<result column="CCVALDATE" jdbcType="VARCHAR" property="CcValDate" />
			<result column="CCEXPDATE" jdbcType="VARCHAR" property="CcExpDate" />
			<result column="MAXGUAR" jdbcType="VARCHAR" property="MaxGuar" />
			<result column="CCSTATUS" jdbcType="VARCHAR" property="CcStatus" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
		</association>

		<!-- <association property="ComRecInfSgmt"javaType="com.hkbank.pbcrs.model.PbcrsReportComrecinfsgmt"></association> -->
		<association property="MotgaProptInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportMotgaproptinfsgmt">
			<id column="MOTGAPROPTINFSGMTSEQNO" jdbcType="VARCHAR"
				property="MotgaProptInfSgmtSeqNo" />
			<result column="PLENM" jdbcType="VARCHAR" property="PleNm" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
			<collection property="PleInf"
				ofType="com.hkbank.pbcrs.model.PbcrsReportPleinf">
				<id column="COMRECINFSGMTSEQNO" jdbcType="VARCHAR" property="ComRecInfSgmtSeqNo" />
				<id column="PLEINFSEQNO" jdbcType="VARCHAR" property="PleInfSeqNo" />
				<result column="PLETYPE" jdbcType="VARCHAR" property="PleType" />
				<result column="MOTGAPROPTIDTYPE" jdbcType="VARCHAR"
					property="MotgaProptIDType" />
				<result column="PLECERTID" jdbcType="VARCHAR" property="PleCertID" />
				<result column="PLEDISTR" jdbcType="VARCHAR" property="PleDistr" />
				<result column="PLEVALUE" jdbcType="VARCHAR" property="PleValue" />
				<result column="PLECY" jdbcType="VARCHAR" property="PleCy" />
				<result column="VALORGTYPE" jdbcType="VARCHAR" property="ValOrgType" />
				<result column="VALDATE" jdbcType="VARCHAR" property="ValDate" />
				<result column="PLEDGORTYPE" jdbcType="VARCHAR" property="PledgorType" />
				<result column="PLEDGORNAME" jdbcType="VARCHAR" property="PledgorName" />
				<result column="PLEORCERTTYPE" jdbcType="VARCHAR" property="PleorCertType" />
				<result column="PLEORCERTNUM" jdbcType="VARCHAR" property="PleorCertNum" />
				<result column="PLEDESC" jdbcType="VARCHAR" property="PleDesc" />
				<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
			</collection>
		</association>

		<association property="CltalInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportCltalinfsgmt">
			<id column="CLTALINFSGMTSEQNO" jdbcType="VARCHAR" property="CltalInfSgmtSeqNo" />
			<result column="IMPNM" jdbcType="VARCHAR" property="ImpNm" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
			<collection property="ImpInf"
				ofType="com.hkbank.pbcrs.model.PbcrsReportImpinf">
				<id column="CLTALINFSGMTSEQNO" jdbcType="VARCHAR" property="CLTALINFSGMTINFSeqNo" />
				<id column="IMPINFSEQNO" jdbcType="VARCHAR" property="ImpInfSeqNo" />
				<result column="IMPTYPE" jdbcType="VARCHAR" property="ImpType" />
				<result column="IMPVAL" jdbcType="VARCHAR" property="ImpVal" />
				<result column="IMPCY" jdbcType="VARCHAR" property="ImpCy" />
				<result column="IPPC" jdbcType="VARCHAR" property="Ippc" />
				<result column="PAWNNAME" jdbcType="VARCHAR" property="PawnName" />
				<result column="PAWNCERTTYPE" jdbcType="VARCHAR" property="PawnCertType" />
				<result column="PAWNCERTNUM" jdbcType="VARCHAR" property="PawnCertNum" />
				<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
			</collection>
		</association>
	</resultMap>
	<sql id="sql_query">

		<if test="queryRptDate != null and queryRptDate != ''">
			and RptDate=#{queryRptDate}
		</if>
		<if test="queryName != null and queryName != ''">
			and Name like '%'||#{queryName}||'%'
		</if>
		<if test="queryCertNum != null and queryCertNum != ''">
			and CertNum like '%'||#{queryCertNum}||'%'
		</if>
		<if test="queryMngmtOrgCode != null and queryMngmtOrgCode != ''">
			and MngmtOrgCode=#{queryMngmtOrgCode}
		</if>

	</sql>
	<delete id="deleteByPrimaryKey" parameterType="String">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Tue Mar 26 
			16:20:32 CST 2019. -->
		delete from PBCRS_REPORT_MOTCLTCTRINF
		where MOTGACLTALCTRCTINFSEQNO = #{MotgaCltalCtrctInfSeqNo,jdbcType=VARCHAR}
	</delete>
	<insert id="insert" parameterType="com.hkbank.pbcrs.model.PbcrsReportMotcltctrinf">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Tue Mar 26 
			16:20:32 CST 2019. -->
		insert into PBCRS_REPORT_MOTCLTCTRINF (MOTGACLTALCTRCTINFSEQNO,
		MOTGACLTALCTRCTBSSGMTSEQNO,
		MOTGACLTALBSINFSGMTSEQNO, COMRECINFSGMTSEQNO,
		MOTGAPROPTINFSGMTSEQNO, CLTALINFSGMTSEQNO
		)
		values (#{MotgaCltalCtrctInfSeqNo,jdbcType=VARCHAR},
		#{MotgaCltalCtrctBsSgmtSeqNo,jdbcType=VARCHAR},
		#{MotgaCltalBsInfSgmtSeqNo,jdbcType=VARCHAR},
		#{ComRecInfSgmtSeqNo,jdbcType=VARCHAR},
		#{MotgaProptInfSgmtSeqNo,jdbcType=VARCHAR},
		#{CltalInfSgmtSeqNo,jdbcType=VARCHAR}
		)
	</insert>
	<update id="updateByPrimaryKey" parameterType="com.hkbank.pbcrs.model.PbcrsReportMotcltctrinf">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Tue Mar 26 
			16:20:32 CST 2019. -->
		update PBCRS_REPORT_MOTCLTCTRINF
		set MOTGACLTALCTRCTBSSGMTSEQNO =
		#{MotgaCltalCtrctBsSgmtSeqNo,jdbcType=VARCHAR},
		MOTGACLTALBSINFSGMTSEQNO =
		#{MotgaCltalBsInfSgmtSeqNo,jdbcType=VARCHAR},
		COMRECINFSGMTSEQNO = #{ComRecInfSgmtSeqNo,jdbcType=VARCHAR},
		MOTGAPROPTINFSGMTSEQNO = #{MotgaProptInfSgmtSeqNo,jdbcType=VARCHAR},
		CLTALINFSGMTSEQNO = #{CltalInfSgmtSeqNo,jdbcType=VARCHAR}
		where MOTGACLTALCTRCTINFSEQNO = #{MotgaCltalCtrctInfSeqNo,jdbcType=VARCHAR}
	</update>
	<select id="selectByPrimaryKey" parameterType="String"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Tue Mar 26 
			16:20:32 CST 2019. -->
		select MOTGACLTALCTRCTINFSEQNO, MOTGACLTALCTRCTBSSGMTSEQNO,
		MOTGACLTALBSINFSGMTSEQNO,
		COMRECINFSGMTSEQNO, MOTGAPROPTINFSGMTSEQNO, CLTALINFSGMTSEQNO
		from PBCRS_REPORT_MOTCLTCTRINF
		where MOTGACLTALCTRCTINFSEQNO = #{MotgaCltalCtrctInfSeqNo,jdbcType=VARCHAR}
	</select>
	<select id="selectAll" resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Tue Mar 26 
			16:20:32 CST 2019. -->
		select MOTGACLTALCTRCTINFSEQNO, MOTGACLTALCTRCTBSSGMTSEQNO,
		MOTGACLTALBSINFSGMTSEQNO,
		COMRECINFSGMTSEQNO, MOTGAPROPTINFSGMTSEQNO, CLTALINFSGMTSEQNO
		from PBCRS_REPORT_MOTCLTCTRINF
	</select>
	<!--分页查询总表关联信息 -->
	<select id="getAllandPage" resultType="map">
		select * from (
		select info.* ,rownum RN from
		(
		select
		info1.MotgaCltalCtrctInfSeqNo,info3.RptDate,info3.InfoIDType,info3.Name,info3.CertType,info3.CertNum,info3.mngmtorgcode
		from PBCRS_REPORT_MOTCLTCTRINF info1
		left join PBCRS_REPORT_MOTCLTCTRINF_MOD info2
		on info1.MotgaCltalCtrctInfSeqNo=info2.MotgaCltalCtrctInfSeqNo
		left join pbcrs_report_MotCltCtrBsSgmt info3
		on
		nvl(info2.MotgaCltalCtrctBsSgmtSeqNo,info1.MotgaCltalCtrctBsSgmtSeqNo)=info3.motgacltalctrctbssgmtseqno
		where 1=1
		<include refid="sql_query" />
		)info where rownum &lt;#{endindex}
		) where RN &gt;=#{startindex}
	</select>
	<!-- 带条件的查询总表 -->
	<select id="getCount" resultType="int">
		select count(1)
		from PBCRS_REPORT_MOTCLTCTRINF info1
		left join PBCRS_REPORT_MOTCLTCTRINF_MOD info2
		on info1.MotgaCltalCtrctInfSeqNo=info2.MotgaCltalCtrctInfSeqNo
		left join pbcrs_report_MotCltCtrBsSgmt info3
		on
		nvl(info2.MotgaCltalCtrctBsSgmtSeqNo,info1.MotgaCltalCtrctBsSgmtSeqNo)=info3.motgacltalctrctbssgmtseqno
		where 1=1
		<include refid="sql_query" />
	</select>
	<select id="selectByPrimaryKeyMod" parameterType="String"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Tue Mar 26 
			16:20:32 CST 2019. -->
		select MOTGACLTALCTRCTINFSEQNO, MOTGACLTALCTRCTBSSGMTSEQNO,
		MOTGACLTALBSINFSGMTSEQNO,
		COMRECINFSGMTSEQNO, MOTGAPROPTINFSGMTSEQNO, CLTALINFSGMTSEQNO
		from PBCRS_REPORT_MOTCLTCTRINF_MOD
		where MOTGACLTALCTRCTINFSEQNO = #{MotgaCltalCtrctInfSeqNo,jdbcType=VARCHAR}
	</select>
	<update id="updateByPrimaryKeyMod" parameterType="com.hkbank.pbcrs.model.PbcrsReportMotcltctrinf">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Tue Mar 26 
			16:20:32 CST 2019. -->
		update PBCRS_REPORT_MOTCLTCTRINF_MOD
		set MOTGACLTALCTRCTBSSGMTSEQNO =
		#{MotgaCltalCtrctBsSgmtSeqNo,jdbcType=VARCHAR},
		MOTGACLTALBSINFSGMTSEQNO =
		#{MotgaCltalBsInfSgmtSeqNo,jdbcType=VARCHAR},
		COMRECINFSGMTSEQNO = #{ComRecInfSgmtSeqNo,jdbcType=VARCHAR},
		MOTGAPROPTINFSGMTSEQNO = #{MotgaProptInfSgmtSeqNo,jdbcType=VARCHAR},
		CLTALINFSGMTSEQNO = #{CltalInfSgmtSeqNo,jdbcType=VARCHAR}
		where MOTGACLTALCTRCTINFSEQNO = #{MotgaCltalCtrctInfSeqNo,jdbcType=VARCHAR}
	</update>
	<insert id="insertMod" parameterType="com.hkbank.pbcrs.model.PbcrsReportMotcltctrinf">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Tue Mar 26 
			16:20:32 CST 2019. -->
		insert into PBCRS_REPORT_MOTCLTCTRINF_MOD (MOTGACLTALCTRCTINFSEQNO,
		MOTGACLTALCTRCTBSSGMTSEQNO,
		MOTGACLTALBSINFSGMTSEQNO, COMRECINFSGMTSEQNO,
		MOTGAPROPTINFSGMTSEQNO, CLTALINFSGMTSEQNO
		)
		values (#{MotgaCltalCtrctInfSeqNo,jdbcType=VARCHAR},
		#{MotgaCltalCtrctBsSgmtSeqNo,jdbcType=VARCHAR},
		#{MotgaCltalBsInfSgmtSeqNo,jdbcType=VARCHAR},
		#{ComRecInfSgmtSeqNo,jdbcType=VARCHAR},
		#{MotgaProptInfSgmtSeqNo,jdbcType=VARCHAR},
		#{CltalInfSgmtSeqNo,jdbcType=VARCHAR}
		)
	</insert>


	<select id="selectByMapCount" parameterType="map" resultType="int">
		select count(1)
		from
		PBCRS_REPORT_MOTCLTCTRBSSGMT t
		left join
		PBCRS_REPORT_MOTCLTBSINFSGMT t1
		on t.MOTGACLTALCTRCTBSSGMTSEQNO = t1.MOTGACLTALBSINFSGMTSEQNO
		and
		t1.ETL_DATE = #{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t1.SOURCESYS = #{sysid}
		</if>
		and t1.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_MOTGAPROPTINFSGMT t2
		on t.MOTGACLTALCTRCTBSSGMTSEQNO =
		t2.MOTGAPROPTINFSGMTSEQNO
		and t2.ETL_DATE = #{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t2.SOURCESYS = #{sysid}
		</if>
		and t2.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_PLEINF t3
		on t2.MOTGAPROPTINFSGMTSEQNO =
		t3.COMRECINFSGMTSEQNO
		and t3.ETL_DATE = #{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t3.SOURCESYS = #{sysid}
		</if>
		and t3.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_CLTALINFSGMT t4
		on t.MOTGACLTALCTRCTBSSGMTSEQNO =
		t4.CLTALINFSGMTSEQNO
		and t4.ETL_DATE = #{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t4.SOURCESYS = #{sysid}
		</if>
		and t4.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_IMPINF t5
		on t4.CLTALINFSGMTSEQNO =
		t5.CLTALINFSGMTSEQNO
		and t5.ETL_DATE =
		#{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t5.SOURCESYS = #{sysid}
		</if>
		and t5.REPORTFLAG = #{REPORTFLAG}
		where t.ETL_DATE = #{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t.SOURCESYS = #{sysid}
		</if>
		and t.REPORTFLAG = #{REPORTFLAG}

	</select>


	<select id="selectByMap" parameterType="map" resultMap="BaseResultMap">
		select * from ( SELECT A.*, ROWNUM RN FROM (


		select
		 t.MOTGACLTALCTRCTBSSGMTSEQNO MOTGACLTALCTRCTINFSEQNO, INFRECTYPE, CCCODE, RPTDATE, RPTDATECODE,
		    INFOIDTYPE,
		    NAME, CERTTYPE, CERTNUM, MNGMTORGCODE,
		    t1.MOTGACLTALBSINFSGMTSEQNO, GUARTYPE, CCAMT, CY, CCVALDATE, CCEXPDATE, MAXGUAR,
		    CCSTATUS,
		    t2.MOTGAPROPTINFSGMTSEQNO, PLENM,
		    t3.COMRECINFSGMTSEQNO, PLEINFSEQNO, PLETYPE, (case when length(t3.COMRECINFSGMTSEQNO)>0 then nvl(MOTGAPROPTIDTYPE,'  ') end )MOTGAPROPTIDTYPE, PLECERTID, 
		    case when length(t3.COMRECINFSGMTSEQNO)>0 then nvl(PLEDISTR,'  ') end  PLEDISTR,
		    case when length(t3.COMRECINFSGMTSEQNO)>0 then nvl(PLEVALUE,'  ') end PLEVALUE, 
		    case when length(t3.COMRECINFSGMTSEQNO)>0 then nvl(PLECY,'  ') end PLECY, 
		    case when length(t3.COMRECINFSGMTSEQNO)>0 then nvl(VALORGTYPE,'  ') end VALORGTYPE, 
		    case when length(t3.COMRECINFSGMTSEQNO)>0 then nvl(VALDATE,'  ') end VALDATE, 
		    PLEDGORTYPE, 
		    PLEDGORNAME,
		    PLEORCERTTYPE, 
		    PLEORCERTNUM,
		    case when length(t3.COMRECINFSGMTSEQNO)>0 then nvl(PLEDESC,'  ') end PLEDESC,
		    t4.CLTALINFSGMTSEQNO,
		    IMPNM,
		    t5.CLTALINFSGMTSEQNO CLTALINFSGMTINFSeqNo,
		    IMPINFSEQNO,
		    IMPTYPE, 
		    IMPVAL,
		    IMPCY,
		    IPPC,
		    PAWNNAME,
		    PAWNCERTTYPE,
		    PAWNCERTNUM
		from
		PBCRS_REPORT_MOTCLTCTRBSSGMT t
		left join
		PBCRS_REPORT_MOTCLTBSINFSGMT t1
		on t.MOTGACLTALCTRCTBSSGMTSEQNO = t1.MOTGACLTALBSINFSGMTSEQNO
		and
		t1.ETL_DATE = #{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t1.SOURCESYS = #{sysid}
		</if>
		and t1.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_MOTGAPROPTINFSGMT t2
		on t.MOTGACLTALCTRCTBSSGMTSEQNO =
		t2.MOTGAPROPTINFSGMTSEQNO
		and t2.ETL_DATE = #{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t2.SOURCESYS = #{sysid}
		</if>
		and t2.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_PLEINF t3
		on t2.MOTGAPROPTINFSGMTSEQNO =
		t3.COMRECINFSGMTSEQNO
		and t3.ETL_DATE = #{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t3.SOURCESYS = #{sysid}
		</if>
		and t3.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_CLTALINFSGMT t4
		on t.MOTGACLTALCTRCTBSSGMTSEQNO =
		t4.CLTALINFSGMTSEQNO
		and t4.ETL_DATE = #{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t4.SOURCESYS = #{sysid}
		</if>
		and t4.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_IMPINF t5
		on t4.CLTALINFSGMTSEQNO =
		t5.CLTALINFSGMTSEQNO
		and t5.ETL_DATE =
		#{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t5.SOURCESYS = #{sysid}
		</if>
		and t5.REPORTFLAG = #{REPORTFLAG}
		where t.ETL_DATE = #{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t.SOURCESYS = #{sysid}
		</if>
		 and t.REPORTFLAG = #{REPORTFLAG} 
		) A where ROWNUM &lt; = #{pageEnd} )
		WHERE RN > #{pageBegin}
	</select>
</mapper>