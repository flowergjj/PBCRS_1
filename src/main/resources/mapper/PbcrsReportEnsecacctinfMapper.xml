<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hkbank.pbcrs.mapper.PbcrsReportEnsecacctinfMapper">
	<resultMap id="BaseResultMap"
		type="com.hkbank.pbcrs.model.PbcrsReportEnsecacctinf">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Mar 14 
			16:52:51 CST 2019. -->
		<id column="ENSECACCTINFSEQNO" jdbcType="VARCHAR" property="EnSecAcctInfSeqNo" />
		<result column="GUARACCTBSSGMTSEQNO" jdbcType="VARCHAR"
			property="GuarAcctBsSgmtSeqNo" />
		<result column="GUARACCTBSINFSGMTSEQNO" jdbcType="VARCHAR"
			property="GuarAcctBsInfSgmtSeqNo" />
		<result column="RLTREPYMTINFSGMTSEQNO" jdbcType="VARCHAR"
			property="RltRepymtInfSgmtSeqNo" />
		<result column="GUARACCTCREDSGMTSEQNO" jdbcType="VARCHAR"
			property="GuarAcctCredSgmtSeqNo" />
		<result column="GUAMOTCLTLCTRINFSGMTSEQNO" jdbcType="VARCHAR"
			property="GuaMotCltlCtrInfSgmtSeqNo" />
		<result column="GUARRLTREPYMTINFSGMTSEQNO" jdbcType="VARCHAR"
			property="GuarRltRepymtInfSgmtSeqNo" />

		<association property="GuarAcctBsSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportEnguaracctbssgmt">
			<id column="GUARACCTBSSGMTSEQNO" jdbcType="VARCHAR" property="GuarAcctBsSgmtSeqNo" />
			<result column="INFRECTYPE" jdbcType="VARCHAR" property="InfRecType" />
			<result column="ACCTTYPE" jdbcType="VARCHAR" property="AcctType" />
			<result column="ACCTCODE" jdbcType="VARCHAR" property="AcctCode" />
			<result column="RPTDATE" jdbcType="VARCHAR" property="RptDate" />
			<result column="RPTDATECODE" jdbcType="VARCHAR" property="RptDateCode" />
			<result column="NAME" jdbcType="VARCHAR" property="Name" />
			<result column="IDTYPE" jdbcType="VARCHAR" property="IDType" />
			<result column="IDNUM" jdbcType="VARCHAR" property="IDNum" />
			<result column="MNGMTORGCODE" jdbcType="VARCHAR" property="MngmtOrgCode" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
		</association>

		<association property="GuarAcctBsInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportEnguaaccbsinfsgmt">
			<id column="GUARACCTBSINFSGMTSEQNO" jdbcType="VARCHAR"
				property="GuarAcctBsInfSgmtSeqNo" />
			<result column="BUSILINES" jdbcType="VARCHAR" property="BusiLines" />
			<result column="BUSIDTILLINES" jdbcType="VARCHAR" property="BusiDtilLines" />
			<result column="OPENDATE" jdbcType="VARCHAR" property="OpenDate" />
			<result column="GUARAMT" jdbcType="VARCHAR" property="GuarAmt" />
			<result column="CY" jdbcType="VARCHAR" property="Cy" />
			<result column="DUEDATE" jdbcType="VARCHAR" property="DueDate" />
			<result column="GUARMODE" jdbcType="VARCHAR" property="GuarMode" />
			<result column="OTHREPYGUARWAY" jdbcType="VARCHAR" property="OthRepyGuarWay" />
			<result column="SECDEP" jdbcType="VARCHAR" property="SecDep" />
			<result column="CTRCTTXTCODE" jdbcType="VARCHAR" property="CtrctTxtCode" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
		</association>

		<association property="RltRepymtInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportGserltrepinfsgmt">
			<id column="RLTREPYMTINFSGMTSEQNO" jdbcType="VARCHAR"
				property="RltRepymtInfSgmtSeqNo" />
			<result column="RLTREPYMTNM" jdbcType="VARCHAR" property="RltRepymtNm" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
			<collection property="RltRepymtInf"
				ofType="com.hkbank.pbcrs.model.PbcrsReportGserltrepymtinf">
				<id column="RLTREPYMTINFSGMTSEQNO" jdbcType="VARCHAR"
					property="RltRepymtInfSgmtSeqNo" />
				<id column="RLTREPYMTINFSEQNO" jdbcType="VARCHAR" property="RltRepymtInfSeqNo" />
				<result column="INFOIDTYPE" jdbcType="VARCHAR" property="InfoIDType" />
				<result column="ARLPNAME" jdbcType="VARCHAR" property="ArlpName" />
				<result column="ARLPCERTTYPE" jdbcType="VARCHAR" property="ArlpCertType" />
				<result column="ARLPCERTNUM" jdbcType="VARCHAR" property="ArlpCertNum" />
				<result column="ARLPTYPE" jdbcType="VARCHAR" property="ArlpType" />
				<result column="ARLPAMT" jdbcType="VARCHAR" property="ArlpAmt" />
				<result column="WARTYSIGN" jdbcType="VARCHAR" property="WartySign" />
				<result column="MAXGUARMCC" jdbcType="VARCHAR" property="MaxGuarMcc" />
				<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
			</collection>
		</association>

		<!-- <association property="GuarMotgaCltalCtrctInfSgmt" javaType="com.hkbank.pbcrs.model.PbcrsReportGuamotcltctrsgmt"> 
			<id column="GUARMOTGACLTALCTRCTINFSGMTSEQN" jdbcType="VARCHAR" property="GuarMotgaCltalCtrctInfSgmtSeqN" 
			/> <result column="CCNM" jdbcType="VARCHAR" property="CcNm" /> <result column="REPORTFLAG" 
			jdbcType="VARCHAR" property="reportflag" /> <collection property="GuaCccInf" 
			ofType="com.hkbank.pbcrs.model.PbcrsReportGuacccinf"> <id column="GUAMOTCLTCTRINFSGMTSEQNO" 
			jdbcType="VARCHAR" property="GuaMotCltCtrInfSgmtSeqNo" /> <id column="CCCINFSEQNO" 
			jdbcType="VARCHAR" property="CccInfSeqNo" /> <result column="CCC" jdbcType="VARCHAR" 
			property="Ccc" /> </collection> </association> -->

		<association property="GuarAcctCredSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportGuaracctcredsgmt">
			<id column="GUARACCTCREDSGMTSEQNO" jdbcType="VARCHAR"
				property="GuarAcctCredSgmtSeqNo" />
			<result column="MCC" jdbcType="VARCHAR" property="Mcc" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
		</association>

		<association property="GuarRltRepymtInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportGuarltrepinfsgmt">
			<id column="GUARRLTREPYMTINFSGMTSEQNO" jdbcType="VARCHAR"
				property="GuarRltRepymtInfSgmtSeqNo" />
			<result column="ACCTSTATUS" jdbcType="VARCHAR" property="AcctStatus" />
			<result column="LOANAMT" jdbcType="VARCHAR" property="LoanAmt" />
			<result column="REPAYPRD" jdbcType="VARCHAR" property="RepayPrd" />
			<result column="FIVECATE" jdbcType="VARCHAR" property="FiveCate" />
			<result column="FIVECATEADJDATE" jdbcType="VARCHAR" property="FiveCateAdjDate" />
			<result column="RIEX" jdbcType="VARCHAR" property="RiEx" />
			<result column="COMPADVFLAG" jdbcType="VARCHAR" property="CompAdvFlag" />
			<result column="CLOSEDATE" jdbcType="VARCHAR" property="CloseDate" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
		</association>
	</resultMap>
	<delete id="deleteByPrimaryKey" parameterType="String">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Mar 14 
			16:52:51 CST 2019. -->
		delete from PBCRS_REPORT_ENSECACCTINF
		where ENSECACCTINFSEQNO =
		#{EnSecAcctInfSeqNo,jdbcType=VARCHAR}
	</delete>
	<insert id="insert" parameterType="com.hkbank.pbcrs.model.PbcrsReportEnsecacctinf">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Mar 14 
			16:52:51 CST 2019. -->
		insert into PBCRS_REPORT_ENSECACCTINF (ENSECACCTINFSEQNO,
		GUARACCTBSSGMTSEQNO,
		GUARACCTBSINFSGMTSEQNO, RLTREPYMTINFSGMTSEQNO,
		GUARACCTCREDSGMTSEQNO, GUAMOTCLTLCTRINFSGMTSEQNO,
		GUARRLTREPYMTINFSGMTSEQNO)
		values
		(#{EnSecAcctInfSeqNo,jdbcType=VARCHAR},
		#{GuarAcctBsSgmtSeqNo,jdbcType=VARCHAR},
		#{GuarAcctBsInfSgmtSeqNo,jdbcType=VARCHAR},
		#{RltRepymtInfSgmtSeqNo,jdbcType=VARCHAR},
		#{GuarAcctCredSgmtSeqNo,jdbcType=VARCHAR},
		#{GuaMotCltlCtrInfSgmtSeqNo,jdbcType=VARCHAR},
		#{GuarRltRepymtInfSgmtSeqNo,jdbcType=VARCHAR})
	</insert>
	<update id="updateByPrimaryKey" parameterType="com.hkbank.pbcrs.model.PbcrsReportEnsecacctinf">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Mar 14 
			16:52:51 CST 2019. -->
		update PBCRS_REPORT_ENSECACCTINF
		set GUARACCTBSSGMTSEQNO =
		#{GuarAcctBsSgmtSeqNo,jdbcType=VARCHAR},
		GUARACCTBSINFSGMTSEQNO =
		#{GuarAcctBsInfSgmtSeqNo,jdbcType=VARCHAR},
		RLTREPYMTINFSGMTSEQNO =
		#{RltRepymtInfSgmtSeqNo,jdbcType=VARCHAR},
		GUARACCTCREDSGMTSEQNO =
		#{GuarAcctCredSgmtSeqNo,jdbcType=VARCHAR},
		GUAMOTCLTLCTRINFSGMTSEQNO =
		#{GuaMotCltlCtrInfSgmtSeqNo,jdbcType=VARCHAR},
		GUARRLTREPYMTINFSGMTSEQNO =
		#{GuarRltRepymtInfSgmtSeqNo,jdbcType=VARCHAR}
		where ENSECACCTINFSEQNO =
		#{EnSecAcctInfSeqNo,jdbcType=VARCHAR}
	</update>
	<select id="selectByPrimaryKey" parameterType="String"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Mar 14 
			16:52:51 CST 2019. -->
		select ENSECACCTINFSEQNO, GUARACCTBSSGMTSEQNO, GUARACCTBSINFSGMTSEQNO,
		RLTREPYMTINFSGMTSEQNO,
		GUARACCTCREDSGMTSEQNO,
		GUAMOTCLTLCTRINFSGMTSEQNO, GUARRLTREPYMTINFSGMTSEQNO
		from
		PBCRS_REPORT_ENSECACCTINF
		where ENSECACCTINFSEQNO =
		#{EnSecAcctInfSeqNo,jdbcType=VARCHAR}
	</select>
	<select id="selectAll" resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Mar 14 
			16:52:51 CST 2019. -->
		select ENSECACCTINFSEQNO, GUARACCTBSSGMTSEQNO, GUARACCTBSINFSGMTSEQNO,
		RLTREPYMTINFSGMTSEQNO,
		GUARACCTCREDSGMTSEQNO,
		GUAMOTCLTLCTRINFSGMTSEQNO, GUARRLTREPYMTINFSGMTSEQNO
		from
		PBCRS_REPORT_ENSECACCTINF
	</select>

	<select id="getKey" resultType="int">
		select
		SEQ_REPORT_ENSECACCTINF.NEXTVAL from dual
	</select>

	<select id="selectByMapCount" parameterType="map" resultType="int">

		select
		count(1)
		from
		PBCRS_REPORT_ENGUARACCTBSSGMT t
		<!-- left join PBCRS_REPORT_ENGUAACCBSINFSGMT t1 on t.GUARACCTBSSGMTSEQNO 
			= t1.GUARACCTBSINFSGMTSEQNO and t1.ETL_DATE = #{etl_Date} <if test="sysid 
			!= null and sysid != ''"> and t1.SOURCESYS = #{sysid} </if> and t1.REPORTFLAG 
			= #{REPORTFLAG} left join PBCRS_REPORT_GSERLTREPINFSGMT t2 on t.GUARACCTBSSGMTSEQNO 
			= t2.RLTREPYMTINFSGMTSEQNO and t2.ETL_DATE = #{etl_Date} <if test="sysid 
			!= null and sysid != ''"> and t2.SOURCESYS = #{sysid} </if> and t2.REPORTFLAG 
			= #{REPORTFLAG} left join PBCRS_REPORT_GSERLTREPYMTINF t6 on t2.RLTREPYMTINFSGMTSEQNO 
			= t6.RLTREPYMTINFSGMTSEQNO and t6.ETL_DATE = #{etl_Date} <if test="sysid 
			!= null and sysid != ''"> and t6.SOURCESYS = #{sysid} </if> and t6.REPORTFLAG 
			= #{REPORTFLAG} left join PBCRS_REPORT_GUARACCTCREDSGMT t4 on t.GUARACCTBSSGMTSEQNO 
			= t4.GUARACCTCREDSGMTSEQNO and t4.ETL_DATE = #{etl_Date} <if test="sysid 
			!= null and sysid != ''"> and t4.SOURCESYS = #{sysid} </if> and t4.REPORTFLAG 
			= #{REPORTFLAG} left join PBCRS_REPORT_EGUARLTREPINFSGMT t5 on t.GUARACCTBSSGMTSEQNO 
			= t5.GUARRLTREPYMTINFSGMTSEQNO and t5.ETL_DATE = #{etl_Date} <if test="sysid 
			!= null and sysid != ''"> and t5.SOURCESYS = #{sysid} </if> and t5.REPORTFLAG 
			= #{REPORTFLAG} -->
		where
		1=1
		<if test="etl_Date != null and etl_Date != ''">
			and t.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t.SOURCESYS = #{sysid}
		</if>
		and t.REPORTFLAG =
		#{REPORTFLAG}


	</select>


	<select id="selectByMap" parameterType="map" resultMap="BaseResultMap">
		select t.GUARACCTBSSGMTSEQNO ENSECACCTINFSEQNO, INFRECTYPE, ACCTTYPE,
		ACCTCODE, RPTDATE, RPTDATECODE,
		NAME, IDTYPE, IDNUM, MNGMTORGCODE,
		t1.GUARACCTBSINFSGMTSEQNO, BUSILINES, BUSIDTILLINES, OPENDATE,
		GUARAMT, CY, DUEDATE,
		GUARMODE, OTHREPYGUARWAY, floor(SECDEP) SECDEP,
		nvl(CTRCTTXTCODE,' ') CTRCTTXTCODE,
		(case when IDNUM != ARLPCERTNUM and
		IDTYPE != ARLPCERTTYPE then t2.RLTREPYMTINFSGMTSEQNO else '' end)
		RLTREPYMTINFSGMTSEQNO
		, (case when IDNUM != ARLPCERTNUM and IDTYPE !=
		ARLPCERTTYPE then RLTREPYMTNM else '' end) RLTREPYMTNM ,
		(case when
		IDNUM != ARLPCERTNUM and IDTYPE != ARLPCERTTYPE then
		t6.RLTREPYMTINFSEQNO else '' end) RltRepymtInfSeqNo,
		(case when IDNUM != ARLPCERTNUM and IDTYPE != ARLPCERTTYPE then INFOIDTYPE
		else '' end) INFOIDTYPE,
		(case when IDNUM != ARLPCERTNUM and IDTYPE != ARLPCERTTYPE then ARLPNAME
		else '' end) ARLPNAME,
		(case when IDNUM != ARLPCERTNUM and IDTYPE != ARLPCERTTYPE then
		ARLPCERTTYPE else '' end) ARLPCERTTYPE,
		(case when IDNUM != ARLPCERTNUM and IDTYPE != ARLPCERTTYPE then ARLPCERTNUM
		else '' end) ARLPCERTNUM,
		(case when IDNUM != ARLPCERTNUM and IDTYPE != ARLPCERTTYPE then ARLPTYPE
		else '' end) ARLPTYPE,
		(case when IDNUM != ARLPCERTNUM and IDTYPE != ARLPCERTTYPE then ARLPAMT
		else '' end) ARLPAMT,
		(case when IDNUM != ARLPCERTNUM and IDTYPE != ARLPCERTTYPE then WARTYSIGN
		else '' end) WARTYSIGN,
		(case when IDNUM != ARLPCERTNUM and IDTYPE != ARLPCERTTYPE then MAXGUARMCC
		else '' end) MAXGUARMCC,
		<!-- t4.GUARACCTCREDSGMTSEQNO, MCC, -->
		(case when RPTDATECODE !='50' then t5.GUARRLTREPYMTINFSGMTSEQNO else
		'' end ) GUARRLTREPYMTINFSGMTSEQNO,
		(case when RPTDATECODE !='50' then
		ACCTSTATUS else '' end )ACCTSTATUS,
		(case when RPTDATECODE !='50' then LOANAMT else '' end )LOANAMT,
		(case when RPTDATECODE !='50' then REPAYPRD else '' end )REPAYPRD,
		(case
		when RPTDATECODE !='50' then FIVECATE else '' end )FIVECATE,
		(case when
		RPTDATECODE !='50' then FIVECATEADJDATE else '' end )FIVECATEADJDATE,
		(case when RPTDATECODE !='50' then nvl(RIEX,' ') else '' end )RIEX,
		(case when RPTDATECODE !='50' then COMPADVFLAG else '' end
		)COMPADVFLAG,
		(case when RPTDATECODE !='50' then (case when ACCTSTATUS = '2' then
		CLOSEDATE else ' ' end) else '' end ) CLOSEDATE

		from (select * from ( SELECT A.*, ROWNUM RN FROM (
		select
		GUARACCTBSSGMTSEQNO , INFRECTYPE, ACCTTYPE,
		ACCTCODE, RPTDATE,
		RPTDATECODE,
		NAME, IDTYPE, IDNUM, MNGMTORGCODE
		from
		PBCRS_REPORT_ENGUARACCTBSSGMT

		where
		1=1
		<if test="etl_Date != null and etl_Date != ''">
			and ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and SOURCESYS = #{sysid}
		</if>
		and REPORTFLAG =
		#{REPORTFLAG}

		) A where ROWNUM &lt; = #{pageEnd} ) WHERE RN > #{pageBegin}) t

		left join
		PBCRS_REPORT_ENGUAACCBSINFSGMT t1
		on t.GUARACCTBSSGMTSEQNO =
		t1.GUARACCTBSINFSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t1.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t1.SOURCESYS = #{sysid}
		</if>
		and t1.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_GSERLTREPINFSGMT t2
		on t.GUARACCTBSSGMTSEQNO =
		t2.RLTREPYMTINFSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t2.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t2.SOURCESYS = #{sysid}
		</if>
		and t2.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_GSERLTREPYMTINF t6
		on t2.RLTREPYMTINFSGMTSEQNO =
		t6.RLTREPYMTINFSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t6.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t6.SOURCESYS = #{sysid}
		</if>
		and t6.REPORTFLAG = #{REPORTFLAG}
		<!-- left join PBCRS_REPORT_GUARACCTCREDSGMT t4 on t.GUARACCTBSSGMTSEQNO 
			= t4.GUARACCTCREDSGMTSEQNO and t4.ETL_DATE = #{etl_Date} <if test="sysid 
			!= null and sysid != ''"> and t4.SOURCESYS = #{sysid} </if> and t4.REPORTFLAG 
			= #{REPORTFLAG} -->
		left join
		PBCRS_REPORT_EGUARLTREPINFSGMT t5
		on t.guaracctbssgmtseqno =
		t5.guarrltrepymtinfsgmtseqno
		<if test="etl_Date != null and etl_Date != ''">
			and t5.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t5.SOURCESYS = #{sysid}
		</if>
		and t5.REPORTFLAG = #{REPORTFLAG}

	</select>

	<update id="updateByMap" parameterType="map">

	</update>
</mapper>