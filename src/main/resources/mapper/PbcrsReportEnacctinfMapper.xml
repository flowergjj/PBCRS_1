<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hkbank.pbcrs.mapper.PbcrsReportEnacctinfMapper">
	<resultMap id="BaseResultMap" type="com.hkbank.pbcrs.model.PbcrsReportEnacctinf">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Mar 13 
			14:37:40 CST 2019. -->
		<id column="ENACCTINFSEQNO" jdbcType="VARCHAR" property="EnAcctInfSeqNo" />
		<result column="ACCTBSSGMTSEQNO" jdbcType="VARCHAR" property="AcctBsSgmtSeqNo" />
		<result column="ACCTBSINFSGMTSEQNO" jdbcType="VARCHAR"
			property="AcctBsInfSgmtSeqNo" />
		<result column="RLTREPYMTINFSGMTSEQNO" jdbcType="VARCHAR"
			property="RltRepymtInfSgmtSeqNo" />
		<result column="MOTGACLTALCTRCTINFSGMTSEQNO" jdbcType="VARCHAR"
			property="MotgaCltalCtrctInfSgmtSeqNo" />
		<result column="ACCTCREDSGMTSEQNO" jdbcType="VARCHAR" property="AcctCredSgmtSeqNo" />
		<result column="ORIGCREDITORINFSGMTSEQNO" jdbcType="VARCHAR"
			property="OrigCreditorInfSgmtSeqNo" />
		<result column="ACTLBLTYINFSGMTSEQNO" jdbcType="VARCHAR"
			property="ActLbltyInfSgmtSeqNo" />
		<result column="ACCTSPECTRSTDSPNSGMTSEQNO" jdbcType="VARCHAR"
			property="AcctSpecTrstDspnSgmtSeqNo" />

		<association property="AcctBsSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportEnacctbssgmt">
			<id column="ACCTBSSGMTSEQNO" jdbcType="VARCHAR" property="AcctBsSgmtSeqNo" />
			<result column="INFRECTYPE" jdbcType="VARCHAR" property="InfRecType" />
			<result column="ACCTTYPE" jdbcType="VARCHAR" property="AcctType" />
			<result column="ACCTCODE" jdbcType="VARCHAR" property="AcctCode" />
			<result column="RPTDATE" jdbcType="VARCHAR" property="RptDate" />
			<result column="RPTDATECODE" jdbcType="VARCHAR" property="RptDateCode" />
			<result column="NAME" jdbcType="VARCHAR" property="Name" />
			<result column="IDTYPE" jdbcType="VARCHAR" property="IDType" />
			<result column="IDNUM" jdbcType="VARCHAR" property="IDNum" />
			<result column="MNGMTORGCODE" jdbcType="VARCHAR" property="MngmtOrgCode" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
		</association>

		<association property="AcctBsInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportEnacctbsinfsgmt">
			<id column="ACCTBSINFSGMTSEQNO" jdbcType="VARCHAR" property="AcctBsInfSgmtSeqNo" />
			<result column="BUSILINES" jdbcType="VARCHAR" property="BusiLines" />
			<result column="BUSIDTLLINES" jdbcType="VARCHAR" property="BusiDtlLines" />
			<result column="OPENDATE" jdbcType="VARCHAR" property="OpenDate" />
			<result column="CY" jdbcType="VARCHAR" property="Cy" />
			<result column="ACCTCREDLINE" jdbcType="VARCHAR" property="AcctCredLine" />
			<result column="LOANAMT" jdbcType="VARCHAR" property="LoanAmt" />
			<result column="FLAG" jdbcType="VARCHAR" property="Flag" />
			<result column="DUEDATE" jdbcType="VARCHAR" property="DueDate" />
			<result column="REPAYMODE" jdbcType="VARCHAR" property="RepayMode" />
			<result column="REPAYFREQCY" jdbcType="VARCHAR" property="RepayFreqcy" />
			<result column="APPLYBUSIDIST" jdbcType="VARCHAR" property="ApplyBusiDist" />
			<result column="GUARMODE" jdbcType="VARCHAR" property="GuarMode" />
			<result column="OTHREPYGUARWAY" jdbcType="VARCHAR" property="OthRepyGuarWay" />
			<result column="LOANTIMELIMCAT" jdbcType="VARCHAR" property="LoanTimeLimCat" />
			<result column="LOAFRM" jdbcType="VARCHAR" property="LoaFrm" />
			<result column="ACTINVEST" jdbcType="VARCHAR" property="ActInvest" />
			<result column="FUNDSOU" jdbcType="VARCHAR" property="FundSou" />
			<result column="ASSETTRANDFLAG" jdbcType="VARCHAR" property="AssetTrandFlag" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
		</association>

		<association property="RltRepInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportEnrltrepinfsgmt">
			<id column="RLTREPYMTINFSGMTSEQNO" jdbcType="VARCHAR"
				property="RltRepymtInfSgmtSeqNo" />
			<result column="RLTREPYMTNM" jdbcType="VARCHAR" property="RltRepymtNm" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
			<collection property="RltRepymtInf"
				ofType="com.hkbank.pbcrs.model.PbcrsReportEnrltrepymtinf">
				<id column="RLTREPYMTINFSGMTSEQNO" jdbcType="VARCHAR"
					property="RltRepymtInfSgmtSeqNo" />
				<id column="RLTREPYMTINFSEQNO" jdbcType="VARCHAR" property="RltRepymtInfSeqNo" />
				<result column="ARLPIDTYPE" jdbcType="VARCHAR" property="ArlpIDType" />
				<result column="ARLPNAME" jdbcType="VARCHAR" property="ArlpName" />
				<result column="ARLPCERTTYPE" jdbcType="VARCHAR" property="ArlpCertType" />
				<result column="ARLPCERTNUM" jdbcType="VARCHAR" property="ArlpCertNum" />
				<result column="ARLPTYPE" jdbcType="VARCHAR" property="ArlpType" />
				<result column="ARLPAMT" jdbcType="VARCHAR" property="ArlpAmt" />
				<result column="WARTYSIGN" jdbcType="VARCHAR" property="WartySign" />
				<result column="MAXGUARMCC" jdbcType="VARCHAR" property="MaxGuarMcc" />
				<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
			</collection>
		</association>

		<association property="MotgaCltalCtrctInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportEnmotcltctrinfsgm">
			<id column="MOTGACLTALCTRCTINFSGMTSEQNO" jdbcType="VARCHAR"
				property="MotgaCltalCtrctInfSgmtSeqNo" />
			<result column="CCNM" jdbcType="VARCHAR" property="CcNm" />

			<collection property="CccInf"
				ofType="com.hkbank.pbcrs.model.PbcrsReportCccinf">
				<id column="MOTGACLTALCTRCTINFSGMTSEQNO" jdbcType="VARCHAR"
					property="MotgaCltalCtrctInfSgmtSeqNo" />
				<id column="CCCINFSEQNO" jdbcType="VARCHAR" property="CccInfSeqNo" />
				<result column="CCC" jdbcType="VARCHAR" property="Ccc" />
				<result column="MOTGACLTALCTRCTINFSEQNO" jdbcType="VARCHAR"
					property="MotgaCltalCtrctInfSeqNo" />
				<result column="MOTGACLTALCTRCTINFTYPE" jdbcType="VARCHAR"
					property="MotgaCltalCtrctInfType" />
				<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
			</collection>
		</association>

		<association property="AcctCredSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportEnacctcredsgmt">
			<id column="ACCTCREDSGMTSEQNO" jdbcType="VARCHAR" property="AcctCredSgmtSeqNo" />
			<result column="MCC" jdbcType="VARCHAR" property="Mcc" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
		</association>

		<association property="OriCreInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportEnoricreinfsgmt">
			<id column="ORIGCREDITORINFSGMTSEQNO" jdbcType="VARCHAR"
				property="OrigCreditorInfSgmtSeqNo" />
			<result column="INITCREDNAME" jdbcType="VARCHAR" property="InitCredName" />
			<result column="INITCEDORGCODE" jdbcType="VARCHAR" property="InitCedOrgCode" />
			<result column="ORIGDBTCATE" jdbcType="VARCHAR" property="OrigDbtCate" />
			<result column="INITRPYSTS" jdbcType="VARCHAR" property="InitRpySts" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
		</association>

		<association property="ActLbltyInfSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportActlbltyinfsgmt">
			<id column="ACTLBLTYINFSGMTSEQNO" jdbcType="VARCHAR" property="ActLbltyInfSgmtSeqNo" />
			<result column="ACCTSTATUS" jdbcType="VARCHAR" property="AcctStatus" />
			<result column="ACCTBAL" jdbcType="VARCHAR" property="AcctBal" />
			<result column="BALCHGDATE" jdbcType="VARCHAR" property="BalChgDate" />
			<result column="FIVECATE" jdbcType="VARCHAR" property="FiveCate" />
			<result column="FIVECATEADJDATE" jdbcType="VARCHAR" property="FiveCateAdjDate" />
			<result column="PYMTPRD" jdbcType="VARCHAR" property="PymtPrd" />
			<result column="TOTOVERD" jdbcType="VARCHAR" property="TotOverd" />
			<result column="OVERDPRINC" jdbcType="VARCHAR" property="OverdPrinc" />
			<result column="OVERDDY" jdbcType="VARCHAR" property="OverdDy" />
			<result column="LATRPYDATE" jdbcType="VARCHAR" property="LatRpyDate" />
			<result column="LATRPYAMT" jdbcType="VARCHAR" property="LatRpyAmt" />
			<result column="LATRPYPRINCAMT" jdbcType="VARCHAR" property="LatRpyPrincAmt" />
			<result column="RPMTTYPE" jdbcType="VARCHAR" property="RpmtType" />
			<result column="LATAGRRRPYDATE" jdbcType="VARCHAR" property="LatAgrrRpyDate" />
			<result column="LATAGRRRPYAMT" jdbcType="VARCHAR" property="LatAgrrRpyAmt" />
			<result column="NXTAGRRRPYDATE" jdbcType="VARCHAR" property="NxtAgrrRpyDate" />
			<result column="CLOSEDATE" jdbcType="VARCHAR" property="CloseDate" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
		</association>

		<association property="AccSpeTrsSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportEnaccspetrssgmt">
			<id column="ACCTSPECTRSTDSPNSGMTSEQNO" jdbcType="VARCHAR"
				property="AcctSpecTrstDspnSgmtSeqNo" />
			<result column="CAGOFTRDNM" jdbcType="VARCHAR" property="CagOfTrdNm" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
			<collection property="EnCagOfTrdInf"
				ofType="com.hkbank.pbcrs.model.PbcrsReportEncagoftrdinf">
				<id column="ACCTSPECTRSTDSPNSGMTSEQNO" jdbcType="VARCHAR"
					property="AcctSpecTrstDspnSgmtSeqNo" />
				<id column="CAGOFTRDINFSEQNO" jdbcType="VARCHAR" property="CagOfTrdInfSeqNo" />
				<result column="CHANTRANTYPE" jdbcType="VARCHAR" property="ChanTranType" />
				<result column="TRANDATE" jdbcType="VARCHAR" property="TranDate" />
				<result column="TRANAMT" jdbcType="VARCHAR" property="TranAmt" />
				<result column="DUETRANMON" jdbcType="VARCHAR" property="DueTranMon" />
				<result column="DETINFO" jdbcType="VARCHAR" property="DetInfo" />
				<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
			</collection>
		</association>
	</resultMap>
	<delete id="
					deleteByPrimaryKey " parameterType="String">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Mar 13 
			14:37:40 CST 2019. -->
		delete from PBCRS_REPORT_ENACCTINF
		where ENACCTINFSEQNO =
		#{EnAcctInfSeqNo,jdbcType=VARCHAR}
	</delete>
	<insert id="insert" parameterType="com.hkbank.pbcrs.model.PbcrsReportEnacctinf">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Mar 13 
			14:37:40 CST 2019. -->
		insert into PBCRS_REPORT_ENACCTINF (ENACCTINFSEQNO,
		ACCTBSSGMTSEQNO,
		ACCTBSINFSGMTSEQNO, RLTREPYMTINFSGMTSEQNO,
		MOTGACLTALCTRCTINFSGMTSEQNO, ACCTCREDSGMTSEQNO,
		ORIGCREDITORINFSGMTSEQNO, ACTLBLTYINFSGMTSEQNO,
		ACCTSPECTRSTDSPNSGMTSEQNO)
		values (#{EnAcctInfSeqNo,jdbcType=VARCHAR},
		#{AcctBsSgmtSeqNo,jdbcType=VARCHAR},
		#{AcctBsInfSgmtSeqNo,jdbcType=VARCHAR},
		#{RltRepymtInfSgmtSeqNo,jdbcType=VARCHAR},
		#{MotgaCltalCtrctInfSgmtSeqNo,jdbcType=VARCHAR},
		#{AcctCredSgmtSeqNo,jdbcType=VARCHAR},
		#{OrigCreditorInfSgmtSeqNo,jdbcType=VARCHAR},
		#{ActLbltyInfSgmtSeqNo,jdbcType=VARCHAR},
		#{AcctSpecTrstDspnSgmtSeqNo,jdbcType=VARCHAR})
	</insert>
	<update id="updateByPrimaryKey" parameterType="com.hkbank.pbcrs.model.PbcrsReportEnacctinf">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Mar 13 
			14:37:40 CST 2019. -->
		update PBCRS_REPORT_ENACCTINF
		set ACCTBSSGMTSEQNO =
		#{AcctBsSgmtSeqNo,jdbcType=VARCHAR},
		ACCTBSINFSGMTSEQNO =
		#{AcctBsInfSgmtSeqNo,jdbcType=VARCHAR},
		RLTREPYMTINFSGMTSEQNO =
		#{RltRepymtInfSgmtSeqNo,jdbcType=VARCHAR},
		MOTGACLTALCTRCTINFSGMTSEQNO
		=
		#{MotgaCltalCtrctInfSgmtSeqNo,jdbcType=VARCHAR},
		ACCTCREDSGMTSEQNO =
		#{AcctCredSgmtSeqNo,jdbcType=VARCHAR},
		ORIGCREDITORINFSGMTSEQNO =
		#{OrigCreditorInfSgmtSeqNo,jdbcType=VARCHAR},
		ACTLBLTYINFSGMTSEQNO =
		#{ActLbltyInfSgmtSeqNo,jdbcType=VARCHAR},
		ACCTSPECTRSTDSPNSGMTSEQNO =
		#{AcctSpecTrstDspnSgmtSeqNo,jdbcType=VARCHAR}
		where ENACCTINFSEQNO =
		#{EnAcctInfSeqNo,jdbcType=VARCHAR}
	</update>
	<select id="selectByPrimaryKey" parameterType="String"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Mar 13 
			14:37:40 CST 2019. -->
		select ENACCTINFSEQNO, ACCTBSSGMTSEQNO, ACCTBSINFSGMTSEQNO,
		RLTREPYMTINFSGMTSEQNO,
		MOTGACLTALCTRCTINFSGMTSEQNO, ACCTCREDSGMTSEQNO,
		ORIGCREDITORINFSGMTSEQNO,
		ACTLBLTYINFSGMTSEQNO,
		ACCTSPECTRSTDSPNSGMTSEQNO
		from PBCRS_REPORT_ENACCTINF
		where
		ENACCTINFSEQNO = #{EnAcctInfSeqNo,jdbcType=VARCHAR}
	</select>
	<select id="selectAll" resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Mar 13 
			14:37:40 CST 2019. -->
		select ENACCTINFSEQNO, ACCTBSSGMTSEQNO, ACCTBSINFSGMTSEQNO,
		RLTREPYMTINFSGMTSEQNO,
		MOTGACLTALCTRCTINFSGMTSEQNO, ACCTCREDSGMTSEQNO,
		ORIGCREDITORINFSGMTSEQNO,
		ACTLBLTYINFSGMTSEQNO,
		ACCTSPECTRSTDSPNSGMTSEQNO
		from PBCRS_REPORT_ENACCTINF
	</select>

	<select id="getKey" resultType="int">
		select
		SEQ_REPORT_ENACCTINF.NEXTVAL from dual
	</select>

	<select id="selectByMapCount" parameterType="map" resultType="int">
		select count(1)
		from
		PBCRS_REPORT_ENACCTBSSGMT t
		<!-- left join PBCRS_REPORT_ENACCTBSINFSGMT t1 on t.ACCTBSSGMTSEQNO = t1.ACCTBSINFSGMTSEQNO 
			and t1.ETL_DATE = #{etl_Date} <if test="sysid != null and sysid != ''"> and 
			t1.SOURCESYS = #{sysid} </if> and t1.REPORTFLAG = #{REPORTFLAG} left join 
			PBCRS_REPORT_ENRLTREPINFSGMT t2 on t.ACCTBSSGMTSEQNO = t2.RLTREPYMTINFSGMTSEQNO 
			and t2.ETL_DATE = #{etl_Date} <if test="sysid != null and sysid != ''"> and 
			t2.SOURCESYS = #{sysid} </if> and t2.REPORTFLAG = #{REPORTFLAG} left join 
			PBCRS_REPORT_ENRLTREPYMTINF t8 on t2.RLTREPYMTINFSGMTSEQNO = t8.RLTREPYMTINFSGMTSEQNO 
			and t8.ETL_DATE = #{etl_Date} <if test="sysid != null and sysid != ''"> and 
			t8.SOURCESYS = #{sysid} </if> and t8.REPORTFLAG = #{REPORTFLAG} left join 
			PBCRS_REPORT_ENMOTCLTCTRINFSGM t3 on t.ACCTBSSGMTSEQNO = t3.MOTGACLTALCTRCTINFSGMTSEQNO 
			and t3.ETL_DATE = #{etl_Date} <if test="sysid != null and sysid != ''"> and 
			t3.SOURCESYS = #{sysid} </if> and t3.REPORTFLAG = #{REPORTFLAG} left join 
			PBCRS_REPORT_CCCINF t9 on t3.MOTGACLTALCTRCTINFSGMTSEQNO = t9.MOTGACLTALCTRCTINFSGMTSEQNO 
			and t9.ETL_DATE = #{etl_Date} <if test="sysid != null and sysid != ''"> and 
			t9.SOURCESYS = #{sysid} </if> and t9.REPORTFLAG = #{REPORTFLAG} left join 
			PBCRS_REPORT_ENACCTCREDSGMT t4 on t.ACCTBSSGMTSEQNO = t4.ACCTCREDSGMTSEQNO 
			and t4.ETL_DATE = #{etl_Date} <if test="sysid != null and sysid != ''"> and 
			t4.SOURCESYS = #{sysid} </if> and t4.REPORTFLAG = #{REPORTFLAG} left join 
			PBCRS_REPORT_ENORICREINFSGMT t5 on t.ACCTBSSGMTSEQNO = t5.ORIGCREDITORINFSGMTSEQNO 
			and t5.ETL_DATE = #{etl_Date} <if test="sysid != null and sysid != ''"> and 
			t5.SOURCESYS = #{sysid} </if> and t5.REPORTFLAG = #{REPORTFLAG} left join 
			PBCRS_REPORT_ACTLBLTYINFSGMT t6 on t.ACCTBSSGMTSEQNO = t6.ACTLBLTYINFSGMTSEQNO 
			and t6.ETL_DATE = #{etl_Date} <if test="sysid != null and sysid != ''"> and 
			t6.SOURCESYS = #{sysid} </if> and t6.REPORTFLAG = #{REPORTFLAG} left join 
			PBCRS_REPORT_ENACCSPETRSSGMT t7 on t.ACCTBSSGMTSEQNO = t7.ACCTSPECTRSTDSPNSGMTSEQNO 
			and t7.ETL_DATE = #{etl_Date} <if test="sysid != null and sysid != ''"> and 
			t7.SOURCESYS = #{sysid} </if> and t7.REPORTFLAG = #{REPORTFLAG} left join 
			PBCRS_REPORT_ENCAGOFTRDINF t10 on t7.ACCTSPECTRSTDSPNSGMTSEQNO = t10.ACCTSPECTRSTDSPNSGMTSEQNO -->
		where 1=1
		<if test="etl_Date != null and etl_Date != ''">
			and t.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t.SOURCESYS = #{sysid}
		</if>
		and t.REPORTFLAG = #{REPORTFLAG}

	</select>


	<select id="selectByMap" parameterType="map" resultMap="BaseResultMap">
		select
		t.ACCTBSSGMTSEQNO ENACCTINFSEQNO, INFRECTYPE, ACCTTYPE,
		ACCTCODE, RPTDATE, RPTDATECODE,
		NAME,
		IDTYPE, IDNUM, MNGMTORGCODE,
		t1.ACCTBSINFSGMTSEQNO, BUSILINES,
		BUSIDTLLINES, OPENDATE, CY,
		(case when ACCTTYPE !='R1' then '' else
		ACCTCREDLINE end) ACCTCREDLINE,
		LOANAMT,
		(case when ACCTTYPE !='D1' then
		'' else FLAG end) FLAG, DUEDATE,
		(case when ACCTTYPE ='D2' then '' else REPAYMODE end) REPAYMODE,
		(case when ACCTTYPE ='D2' then ''
		when REPAYMODE = '90' then '10'
		else REPAYFREQCY end) REPAYFREQCY,
		nvl(APPLYBUSIDIST,' ')APPLYBUSIDIST,
		GUARMODE,
		OTHREPYGUARWAY,
		(case when ACCTTYPE ='D2' then '' else LOANTIMELIMCAT end) LOANTIMELIMCAT,
		LOAFRM,
		(case when ACCTTYPE ='D2' then '' else ACTINVEST end)
		ACTINVEST, FUNDSOU,
		(case when ACCTTYPE ='D2' then '' else ASSETTRANDFLAG end) ASSETTRANDFLAG,
		t2.RLTREPYMTINFSGMTSEQNO,
		RLTREPYMTNM,
		t8.RLTREPYMTINFSEQNO
		RltRepymtInfSeqNo,
		ARLPIDTYPE, ARLPNAME, ARLPCERTTYPE,ARLPCERTNUM,
		ARLPTYPE,
		ARLPAMT, WARTYSIGN, MAXGUARMCC,
		(case when ACCTTYPE ='D2' then ''
		when ACCTTYPE ='C1' then '' else t3.MOTGACLTALCTRCTINFSGMTSEQNO end)
		MOTGACLTALCTRCTINFSGMTSEQNO,
		(case when ACCTTYPE ='D2' then ''
		when ACCTTYPE ='C1' then '' else CCNM end
		) CCNM,
		(case when ACCTTYPE ='D2' then ''
		when ACCTTYPE ='C1' then ''
		else t9.CCCINFSEQNO end) CccInfSeqNo,
		(case when ACCTTYPE ='C1' then ''
		when ACCTTYPE ='D2' then '' else CCC end) CCC,
		(case when ACCTTYPE ='D1' and FLAG = '0' then ''
		when ACCTTYPE ='D2' then ''
		when ACCTTYPE ='C1' then ''
		else t4.ACCTCREDSGMTSEQNO end) ACCTCREDSGMTSEQNO,
		(case when ACCTTYPE ='D1' and FLAG = '0' then ''
		when ACCTTYPE ='D2' then ''
		when ACCTTYPE ='C1' then ''
		else MCC end) MCC,
		t5.ORIGCREDITORINFSGMTSEQNO,
		INITCREDNAME,
		INITCEDORGCODE, ORIGDBTCATE, INITRPYSTS,
		t6.ACTLBLTYINFSGMTSEQNO,
		ACCTSTATUS, ACCTBAL, BALCHGDATE,
		FIVECATE,
		FIVECATEADJDATE,
		(case when
		accttype !='R1' THEN '' ELSE PYMTPRD END) PYMTPRD,
		TOTOVERD, OVERDPRINC, OVERDDY, LATRPYDATE,
		LATRPYAMT,
		LATRPYPRINCAMT, RPMTTYPE,
		LATAGRRRPYDATE, LATAGRRRPYAMT,
		NXTAGRRRPYDATE,
		(case when ACCTSTATUS = '21' then CLOSEDATE else ' ' end) CLOSEDATE,
		t7.ACCTSPECTRSTDSPNSGMTSEQNO, CAGOFTRDNM,
		t10.CAGOFTRDINFSEQNO
		CagOfTrdInfSeqNo,
		CHANTRANTYPE, TRANDATE, TRANAMT,DUETRANMON, DETINFO

		from (select * from ( SELECT A.*, ROWNUM RN FROM ( select
		ACCTBSSGMTSEQNO, INFRECTYPE, ACCTTYPE,
		ACCTCODE, RPTDATE, RPTDATECODE,
		NAME,
		IDTYPE, IDNUM, MNGMTORGCODE
		from
		PBCRS_REPORT_ENACCTBSSGMT t

		where 1=1
		<if test="etl_Date != null and etl_Date != ''">
			and t.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and SOURCESYS = #{sysid}
		</if>
		and REPORTFLAG = #{REPORTFLAG}
		) A where ROWNUM &lt; = #{pageEnd} )
		WHERE RN > #{pageBegin}) t

		left join
		PBCRS_REPORT_ENACCTBSINFSGMT t1
		on
		t.ACCTBSSGMTSEQNO =
		t1.ACCTBSINFSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t1.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t1.SOURCESYS = #{sysid}
		</if>
		and t1.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_ENRLTREPINFSGMT t2
		on t.ACCTBSSGMTSEQNO =
		t2.RLTREPYMTINFSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t2.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t2.SOURCESYS = #{sysid}
		</if>
		and t2.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_ENRLTREPYMTINF
		t8
		on t2.RLTREPYMTINFSGMTSEQNO = t8.RLTREPYMTINFSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t8.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t8.SOURCESYS = #{sysid}
		</if>
		and t8.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_ENMOTCLTCTRINFSGM t3
		on t.ACCTBSSGMTSEQNO =
		t3.MOTGACLTALCTRCTINFSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t3.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t3.SOURCESYS = #{sysid}
		</if>
		and t3.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_CCCINF t9
		on
		t3.MOTGACLTALCTRCTINFSGMTSEQNO = t9.MOTGACLTALCTRCTINFSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t9.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t9.SOURCESYS = #{sysid}
		</if>
		and t9.REPORTFLAG = #{REPORTFLAG}
		and t9.MotgaCltalCtrctInfType='MO'
		left join
		PBCRS_REPORT_ENACCTCREDSGMT
		t4
		on t.ACCTBSSGMTSEQNO =
		t4.ACCTCREDSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t4.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t4.SOURCESYS = #{sysid}
		</if>
		and t4.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_ENORICREINFSGMT t5
		on t.ACCTBSSGMTSEQNO =
		t5.ORIGCREDITORINFSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t5.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t5.SOURCESYS = #{sysid}
		</if>
		and t5.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_ACTLBLTYINFSGMT t6
		on t.ACCTBSSGMTSEQNO =
		t6.ACTLBLTYINFSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t6.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t6.SOURCESYS = #{sysid}
		</if>
		and t6.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_ENACCSPETRSSGMT t7
		on t.ACCTBSSGMTSEQNO =
		t7.ACCTSPECTRSTDSPNSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t7.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t7.SOURCESYS = #{sysid}
		</if>
		and t7.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_ENCAGOFTRDINF
		t10
		on t7.ACCTSPECTRSTDSPNSGMTSEQNO = t10.ACCTSPECTRSTDSPNSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t10.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t10.SOURCESYS = #{sysid}
		</if>
		and t10.REPORTFLAG = #{REPORTFLAG}
	</select>

	<update id="updateByMap" parameterType="map">

	</update>
</mapper>