<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hkbank.pbcrs.mapper.PbcrsReportEnctrctinfMapper">
	<resultMap id="BaseResultMap" type="com.hkbank.pbcrs.model.PbcrsReportEnctrctinf">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Mar 15 
			10:00:01 CST 2019. -->
		<id column="ENCTRCTINFSEQNO" jdbcType="VARCHAR" property="EnCtrctInfSeqNo" />
		<result column="CTRCTBSSGMTSEQNO" jdbcType="VARCHAR" property="CtrctBsSgmtSeqNo" />
		<result column="CTRCTCERTRELSGMTSEQNO" jdbcType="VARCHAR"
			property="CtrctCertRelSgmtSeqNo" />
		<result column="CREDITLIMSGMTSEQNO" jdbcType="VARCHAR"
			property="CreditLimSgmtSeqNo" />

		<association property="CtrctBsSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportEnctrctbssgmt">
			<id column="CTRCTBSSGMTSEQNO" jdbcType="VARCHAR" property="CtrctBsSgmtSeqNo" />
			<result column="INFRECTYPE" jdbcType="VARCHAR" property="InfRecType" />
			<result column="CONTRACTCODE" jdbcType="VARCHAR" property="ContractCode" />
			<result column="RPTDATE" jdbcType="VARCHAR" property="RptDate" />
			<result column="RPTDATECODE" jdbcType="VARCHAR" property="RptDateCode" />
			<result column="NAME" jdbcType="VARCHAR" property="Name" />
			<result column="IDTYPE" jdbcType="VARCHAR" property="IDType" />
			<result column="IDNUM" jdbcType="VARCHAR" property="IDNum" />
			<result column="MNGMTORGCODE" jdbcType="VARCHAR" property="MngmtOrgCode" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
		</association>

		<association property="CtrctCertRelSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportEnctrcerrelsgmt">
			<id column="CTRCTCERTRELSGMTSEQNO" jdbcType="VARCHAR"
				property="CtrctCertRelSgmtSeqNo" />
			<result column="BRERNM" jdbcType="VARCHAR" property="BrerNm" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
			<collection property="CtrctCertRel"
				ofType="com.hkbank.pbcrs.model.PbcrsReportEnctrctcertrel">
				<id column="CTRCTCERTRELSGMTSEQNO" jdbcType="VARCHAR"
					property="CtrctCertRelSgmtSeqNo" />
				<id column="CTRCTCERTRELSEQNO" jdbcType="VARCHAR" property="CtrctCertRelSeqNo" />
				<result column="BRERTYPE" jdbcType="VARCHAR" property="BrerType" />
				<result column="CERTRELNAME" jdbcType="VARCHAR" property="CertRelName" />
				<result column="CERTRELIDTYPE" jdbcType="VARCHAR" property="CertRelIDType" />
				<result column="CERTRELIDNUM" jdbcType="VARCHAR" property="CertRelIDNum" />
				<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
			</collection>
		</association>

		<association property="CreditLimSgmt"
			javaType="com.hkbank.pbcrs.model.PbcrsReportEncreditlimsgmt">
			<id column="CREDITLIMSGMTSEQNO" jdbcType="VARCHAR" property="CreditLimSgmtSeqNo" />
			<result column="CREDITLIMTYPE" jdbcType="VARCHAR" property="CreditLimType" />
			<result column="LIMLOOPFLG" jdbcType="VARCHAR" property="LimLoopFlg" />
			<result column="CREDITLIM" jdbcType="VARCHAR" property="CreditLim" />
			<result column="CY" jdbcType="VARCHAR" property="Cy" />
			<result column="CONEFFDATE" jdbcType="VARCHAR" property="ConEffDate" />
			<result column="CONEXPDATE" jdbcType="VARCHAR" property="ConExpDate" />
			<result column="CONSTATUS" jdbcType="VARCHAR" property="ConStatus" />
			<result column="CREDITRESTCODE" jdbcType="VARCHAR" property="CreditRestCode" />
			<result column="CREDITREST" jdbcType="VARCHAR" property="CreditRest" />
			<result column="REPORTFLAG" jdbcType="VARCHAR" property="ReportFlag" />
		</association>
	</resultMap>
	<delete id="deleteByPrimaryKey" parameterType="String">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Mar 15 
			10:00:01 CST 2019. -->
		delete from PBCRS_REPORT_ENCTRCTINF
		where ENCTRCTINFSEQNO =
		#{EnCtrctInfSeqNo,jdbcType=VARCHAR}
	</delete>
	<insert id="insert" parameterType="com.hkbank.pbcrs.model.PbcrsReportEnctrctinf">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Mar 15 
			10:00:01 CST 2019. -->
		insert into PBCRS_REPORT_ENCTRCTINF (ENCTRCTINFSEQNO,
		CTRCTBSSGMTSEQNO,
		CTRCTCERTRELSGMTSEQNO, CREDITLIMSGMTSEQNO
		)
		values
		(#{EnCtrctInfSeqNo,jdbcType=VARCHAR},
		#{CtrctBsSgmtSeqNo,jdbcType=VARCHAR},
		#{CtrctCertRelSgmtSeqNo,jdbcType=VARCHAR},
		#{CreditLimSgmtSeqNo,jdbcType=VARCHAR}
		)
	</insert>
	<update id="updateByPrimaryKey" parameterType="com.hkbank.pbcrs.model.PbcrsReportEnctrctinf">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Mar 15 
			10:00:01 CST 2019. -->
		update PBCRS_REPORT_ENCTRCTINF
		set CTRCTBSSGMTSEQNO =
		#{CtrctBsSgmtSeqNo,jdbcType=VARCHAR},
		CTRCTCERTRELSGMTSEQNO =
		#{CtrctCertRelSgmtSeqNo,jdbcType=VARCHAR},
		CREDITLIMSGMTSEQNO =
		#{CreditLimSgmtSeqNo,jdbcType=VARCHAR}
		where ENCTRCTINFSEQNO =
		#{EnCtrctInfSeqNo,jdbcType=VARCHAR}
	</update>
	<select id="selectByPrimaryKey" parameterType="String"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Mar 15 
			10:00:01 CST 2019. -->
		select ENCTRCTINFSEQNO, CTRCTBSSGMTSEQNO, CTRCTCERTRELSGMTSEQNO,
		CREDITLIMSGMTSEQNO
		from PBCRS_REPORT_ENCTRCTINF
		where ENCTRCTINFSEQNO =
		#{EnCtrctInfSeqNo,jdbcType=VARCHAR}
	</select>
	<select id="selectAll" resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Mar 15 
			10:00:01 CST 2019. -->
		select ENCTRCTINFSEQNO, CTRCTBSSGMTSEQNO, CTRCTCERTRELSGMTSEQNO,
		CREDITLIMSGMTSEQNO
		from PBCRS_REPORT_ENCTRCTINF
	</select>
	<select id="getKey" resultType="int">
		select
		SEQ_REPORT_ENCTRCTINF.NEXTVAL from dual
	</select>


	<select id="selectByMapCount" parameterType="map" resultType="int">
	
		select count(1)
		from PBCRS_REPORT_ENCTRCTBSSGMT t
<!-- 		left join
		PBCRS_REPORT_ENCTRCERRELSGMT t1
		on t.CTRCTBSSGMTSEQNO =
		t1.CTRCTCERTRELSGMTSEQNO
		and t1.ETL_DATE = #{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t1.SOURCESYS = #{sysid}
		</if>
		and t1.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_ENCTRCTCERTREL
		t3
		on t1.CTRCTCERTRELSGMTSEQNO = t3.CTRCTCERTRELSGMTSEQNO
		and
		t3.ETL_DATE = #{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t3.SOURCESYS = #{sysid}
		</if>
		and t3.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_ENCREDITLIMSGMT t2
		on t.CTRCTBSSGMTSEQNO =
		t2.CREDITLIMSGMTSEQNO
		and t2.ETL_DATE = #{etl_Date}
		<if test="sysid != null and sysid != ''">
			and t2.SOURCESYS = #{sysid}
		</if>
		and t2.REPORTFLAG = #{REPORTFLAG} -->
		where 1=1
		<if test="etl_Date != null and etl_Date != ''">
			and t.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t.SOURCESYS = #{sysid}
		</if>
		and t.REPORTFLAG = #{REPORTFLAG}
		
	</select>


	<select id="selectByMap" parameterType="map" resultMap="BaseResultMap">
	select * from ( SELECT A.*, ROWNUM RN FROM  ( 
		select t.CTRCTBSSGMTSEQNO ENCTRCTINFSEQNO, INFRECTYPE, CONTRACTCODE,
		RPTDATE, RPTDATECODE, NAME, IDTYPE,
		IDNUM, MNGMTORGCODE,
		t1.CTRCTCERTRELSGMTSEQNO, BRERNM,
		BRERTYPE, CERTRELNAME,
		CERTRELIDTYPE,CERTRELIDNUM,
		t2.CREDITLIMSGMTSEQNO, CREDITLIMTYPE,
		LIMLOOPFLG, CREDITLIM, CY, CONEFFDATE,
		CONEXPDATE, CONSTATUS,
		CREDITRESTCODE, CREDITREST
		from PBCRS_REPORT_ENCTRCTBSSGMT t
		left join
		PBCRS_REPORT_ENCTRCERRELSGMT t1
		on t.CTRCTBSSGMTSEQNO =
		t1.CTRCTCERTRELSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t1.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t1.SOURCESYS = #{sysid}
		</if>
		and t1.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_ENCTRCTCERTREL
		t3
		on t1.CTRCTCERTRELSGMTSEQNO = t3.CTRCTCERTRELSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t3.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t3.SOURCESYS = #{sysid}
		</if>
		and t3.REPORTFLAG = #{REPORTFLAG}
		left join
		PBCRS_REPORT_ENCREDITLIMSGMT t2
		on t.CTRCTBSSGMTSEQNO =
		t2.CREDITLIMSGMTSEQNO
		<if test="etl_Date != null and etl_Date != ''">
			and t2.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t2.SOURCESYS = #{sysid}
		</if>
		and t2.REPORTFLAG = #{REPORTFLAG}
		where 1=1
		<if test="etl_Date != null and etl_Date != ''">
			and t.ETL_DATE = #{etl_Date}
		</if>
		<if test="sysid != null and sysid != ''">
			and t.SOURCESYS = #{sysid}
		</if>
		and t.REPORTFLAG = #{REPORTFLAG}
		) A where ROWNUM  &lt; = #{pageEnd} ) WHERE RN > #{pageBegin}
	</select>

	<update id="updateByMap" parameterType="map">

	</update>
</mapper>