<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hkbank.pbcrs.mapper.PbcrsReportIdsgmtMapper">
  <resultMap id="BaseResultMap" type="com.hkbank.pbcrs.model.PbcrsReportIdsgmt">
    <!--
      WARNING - 
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 11:14:08 CST 2019.
    -->
    <id column="IDSGMTSEQNO" jdbcType="VARCHAR" property="IDSgmtSeqNo" />
    <result column="IDNM" jdbcType="VARCHAR" property="IDNm" />
    <result column="IDINFOUPDATE" jdbcType="VARCHAR" property="IDInfoUpDate" />
    <result column="REPORTFLAG" jdbcType="VARCHAR" property="reportflag" />
  </resultMap>
  <sql id="sql_query">
		
			<if test="queryDate != null and queryDate != ''">
				and baseinfo.rptdate=#{queryDate}
			</if>
			<if test="queryName != null and queryName != ''">
				and baseinfo.name=#{queryName}
			</if>
			<if test="queryNum != null and queryNum != ''">
				and baseinfo.idnum=#{queryNum}
			</if>
			<if test="queryCimoc != null and queryCimoc != ''">
				and baseinfo.cimoc=#{queryCimoc}
			</if>
		
	</sql>
  <delete id="deleteByPrimaryKey" parameterType="String">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 11:14:08 CST 2019.
    -->
    delete from PBCRS_REPORT_IDSGMT
    where IDSGMTSEQNO = #{IDSgmtSeqNo,jdbcType=VARCHAR}
  </delete>
   <delete id="deleteByPrimaryKeyM" parameterType="String">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 11:14:08 CST 2019.
    -->
    delete from PBCRS_REPORT_IDSGMTM
    where IDSGMTSEQNO = #{IDSgmtSeqNo,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.hkbank.pbcrs.model.PbcrsReportIdsgmt">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 11:14:08 CST 2019.
    -->
    insert into PBCRS_REPORT_IDSGMT (IDSGMTSEQNO, IDNM, IDINFOUPDATE, 
      REPORTFLAG)
    values (#{IDSgmtSeqNo,jdbcType=VARCHAR}, #{IDNm,jdbcType=VARCHAR}, #{IDInfoUpDate,jdbcType=VARCHAR}, 
      #{reportflag,jdbcType=VARCHAR})
  </insert>
   <insert id="insertM" parameterType="String">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 11:14:08 CST 2019.
    -->
    insert into PBCRS_REPORT_IDSGMTM (IDSGMTSEQNO, IDNM, IDINFOUPDATE, 
      REPORTFLAG,
		ETL_DATE,SOURCESYS) select IDSGMTSEQNO, IDNM, IDINFOUPDATE, '0',
		ETL_DATE,SOURCESYS
    from PBCRS_REPORT_IDSGMT
    where IDSGMTSEQNO = #{IDSgmtSeqNo,jdbcType=VARCHAR} 
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.hkbank.pbcrs.model.PbcrsReportIdsgmt">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 11:14:08 CST 2019.
    -->
    update PBCRS_REPORT_IDSGMT
    set IDNM = #{IDNm,jdbcType=VARCHAR},
      IDINFOUPDATE = #{IDInfoUpDate,jdbcType=VARCHAR},
      REPORTFLAG = #{reportflag,jdbcType=VARCHAR}
    where IDSGMTSEQNO = #{IDSgmtSeqNo,jdbcType=VARCHAR}
  </update>
  <select id="selectByPrimaryKey" parameterType="String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 11:14:08 CST 2019.
    -->
    select IDSGMTSEQNO, IDNM, IDINFOUPDATE, REPORTFLAG
    from PBCRS_REPORT_IDSGMT
    where IDSGMTSEQNO = #{IDSgmtSeqNo,jdbcType=VARCHAR}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 11:14:08 CST 2019.
    -->
    select IDSGMTSEQNO, IDNM, IDINFOUPDATE, REPORTFLAG
    from PBCRS_REPORT_IDSGMT
  </select>
 <!-- 分页查询其他标示段关联的列表信息 -->
  <select id="getIdRecList" resultType="map" parameterType="map">
  select * from (
       select info.*,rownum rn from (
              select sgmt.idsgmtseqno,rec.IDSGMTLISTSEQNO,rec.alias,rec.othidtype,rec.othidnum
              from pbcrs_report_idsgmt sgmt  join pbcrs_report_idrec rec 
              on sgmt.idsgmtseqno=rec.idsgmtseqno 
              where sgmt.idsgmtseqno = #{idSgmtSeqNo}
              <include refid="sql_query"/>
              ) info
       where rownum &lt; #{endindex}
   )where rn &gt;= #{startindex}
  </select>
  <!-- 分页查询其他标示段关联的列表信息总数 -->
  <select id="getIdRecListTotal" resultType="int" parameterType="map">
              select count(1)
              from pbcrs_report_idsgmt sgmt  join pbcrs_report_idrec rec 
              on sgmt.idsgmtseqno=rec.idsgmtseqno 
              where sgmt.idsgmtseqno = #{idSgmtSeqNo}
              <include refid="sql_query"/>
  </select>
  <select id="getKey" resultType="int">
  		select SEQ_REPORT_IDSGMT.NEXTVAL from dual
  </select>
</mapper>